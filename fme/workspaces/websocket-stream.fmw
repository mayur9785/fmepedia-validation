#! <?xml version="1.0" encoding="utf-8" ?>
#! <WORKSPACE
#    
#    
#    Command-line to run this workspace:
#    
#    
#    C:\Apps\FME_15208_64\fme.exe C:\safegit\fmepedia-validation\fme\workspaces\websocket-stream.fmw
#          --minID 1
#          --maxID 300
#          --type i
#    
#    
#! USAGE=""
#! FME_BUILD_NUM="15208"
#! ATTR_TYPE_ENCODING="SDF"
#! FME_SERVER_SERVICES=""
#! FME_IMPLICIT_CSMAP_REPROJECTION_MODE="Auto"
#! LOG_MAX_RECORDED_FEATURES="200"
#! LEGAL_TERMS_CONDITIONS=""
#! DESTINATION="NONE"
#! WARN_INVALID_XFORM_PARAM="Yes"
#! FME_DOCUMENT_PRIORGUID="445e16ff-4d88-46e2-a1b4-6b7f930db9f4,3f5bcf1d-8c16-471d-bb6b-254d5438abdc"
#! VIEW_POSITION="204.002 222.002"
#! DESCRIPTION=""
#! FME_DOCUMENT_GUID="282ac65c-ba40-4813-b14d-90db2d1acc01"
#! FME_GEOMETRY_HANDLING="Enhanced"
#! REQUIREMENTS_KEYWORD=""
#! LAST_SAVE_BUILD="FME(R) 2015 (20141104 - Build 15208 - WIN64)"
#! SOURCE_ROUTING_FILE=""
#! REDIRECT_TERMINATORS="NONE"
#! SOURCE="NONE"
#! DESTINATION_ROUTING_FILE=""
#! SHOW_INFO_NODES="true"
#! END_PYTHON=""
#! SHOW_ANNOTATIONS="true"
#! ZOOM_SCALE="100"
#! LOG_FILE=""
#! CATEGORY=""
#! REQUIREMENTS=""
#! TITLE=""
#! FME_STROKE_MAX_DEVIATION="0"
#! HISTORY=""
#! LAST_SAVE_DATE="2014-11-21T11:30:58"
#! DOC_EXTENTS="1759.03 398.92"
#! LOG_MAX_PRECISION="Yes"
#! MULTI_WRITER_DATASET_ORDER="BY_ID"
#! WORKSPACE_VERSION="1"
#! IGNORE_READER_FAILURE="No"
#! FME_REPROJECTION_ENGINE="FME"
#! MAX_LOG_FEATURES="200"
#! BEGIN_PYTHON=""
#! END_TCL=""
#! BEGIN_TCL=""
#! PASSWORD=""
#! DOC_TOP_LEFT="675.006 -519.005"
#! >
#! <DATASETS>
#! </DATASETS>
#! <DATA_TYPES>
#! </DATA_TYPES>
#! <GEOM_TYPES>
#! </GEOM_TYPES>
#! <FEATURE_TYPES>
#! </FEATURE_TYPES>
#! <FMESERVER>
#! <SERVICES>
#! <SERVICE
#! NAME="fmejobsubmitter"
#! >
#! <PROPERTIES>
#! <PROPERTY
#! CATEGORY="FMEUSERPROPDATA"
#! NAME="ADVANCED"
#! VALUE=""
#! />
#! <PROPERTY
#! CATEGORY="FMEUSERPROPDATA"
#! NAME="FAILURE_TOPICS"
#! VALUE=""
#! />
#! <PROPERTY
#! CATEGORY="FMEUSERPROPDATA"
#! NAME="HTTP_DATASET"
#! VALUE=""
#! />
#! <PROPERTY
#! CATEGORY="FMEUSERPROPDATA"
#! NAME="NOTIFICATION_WRITER"
#! VALUE=""
#! />
#! <PROPERTY
#! CATEGORY="FMEUSERPROPDATA"
#! NAME="SUCCESS_TOPICS"
#! VALUE=""
#! />
#! </PROPERTIES>
#! </SERVICE>
#! </SERVICES>
#! <REPOSITORY
#! NAME="validation"
#! />
#! <ITEM
#! NAME="websocket-stream.fmw"
#! />
#! </FMESERVER>
#! <GLOBAL_PARAMETERS>
#! <GLOBAL_PARAMETER
#! GUI_LINE="GUI OPTIONAL INTEGER_OR_ATTR minID Minimum ID:"
#! DEFAULT_VALUE="1"
#! IS_STAND_ALONE="true"
#! />
#! <GLOBAL_PARAMETER
#! GUI_LINE="GUI OPTIONAL INTEGER_OR_ATTR maxID Maximum ID:"
#! DEFAULT_VALUE="300"
#! IS_STAND_ALONE="true"
#! />
#! <GLOBAL_PARAMETER
#! GUI_LINE="GUI OPTIONAL TEXT_OR_ATTR type Type:"
#! DEFAULT_VALUE="i"
#! IS_STAND_ALONE="true"
#! />
#! <GLOBAL_PARAMETER
#! GUI_LINE="GUI IGNORE TEXT_OR_ATTR WEBSOCKET_URL WebSocket Server URL:"
#! DEFAULT_VALUE="wss://myfmeserver:7078/websocket"
#! IS_STAND_ALONE="false"
#! />
#! </GLOBAL_PARAMETERS>
#! <COMMENTS>
#! </COMMENTS>
#! <CONSTANTS>
#! </CONSTANTS>
#! <BOOKMARKS>
#! </BOOKMARKS>
#! <TRANSFORMERS>
#! <TRANSFORMER
#! IDENTIFIER="18"
#! TYPE="SubDocumentTransformer"
#! VERSION="0"
#! POSITION="1226.49 -120.085"
#! BOUNDING_RECT="1226.49 -120.085 502.519 71"
#! ORDER="5e+014"
#! PARMS_EDITED="true"
#! ENABLED="true"
#! LAST_PARM_EDIT="15208"
#! >
#! <OUTPUT_FEAT NAME="Output"/>
#! <FEAT_COLLAPSED COLLAPSED="0"/>
#! <XFORM_ATTR ATTR_NAME="feature_id" IS_USER_CREATED="false" FEAT_INDEX="0" />
#! <XFORM_PARM PARM_NAME="TRANSFORMER_GROUP" PARM_VALUE=""/>
#! <XFORM_PARM PARM_NAME="type" PARM_VALUE="$(type)"/>
#! <XFORM_PARM PARM_NAME="__COMPOUND_PARAMETERS" PARM_VALUE=""/>
#! <XFORM_PARM PARM_NAME="minID" PARM_VALUE="$(minID)"/>
#! <XFORM_PARM PARM_NAME="maxID" PARM_VALUE="$(maxID)"/>
#! <XFORM_PARM PARM_NAME="SUB_DOC_NAME" PARM_VALUE="DatabaseQueryLooper"/>
#! <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="DatabaseQueryLooper"/>
#! </TRANSFORMER>
#! <TRANSFORMER
#! IDENTIFIER="2"
#! TYPE="Creator"
#! VERSION="5"
#! POSITION="675.006 -120.085"
#! BOUNDING_RECT="675.006 -120.085 -1 -1"
#! ORDER="5e+014"
#! PARMS_EDITED="false"
#! ENABLED="true"
#! LAST_PARM_EDIT="15208"
#! >
#! <OUTPUT_FEAT NAME="CREATED"/>
#! <FEAT_COLLAPSED COLLAPSED="0"/>
#! <XFORM_ATTR ATTR_NAME="_creation_instance" IS_USER_CREATED="false" FEAT_INDEX="0" />
#! <XFORM_PARM PARM_NAME="TRANSFORMER_GROUP" PARM_VALUE=""/>
#! <XFORM_PARM PARM_NAME="COORDS" PARM_VALUE="&lt;Unused&gt;"/>
#! <XFORM_PARM PARM_NAME="CRE_ATTR" PARM_VALUE="_creation_instance"/>
#! <XFORM_PARM PARM_NAME="GEOM" PARM_VALUE="&lt;lt&gt;?xml&lt;space&gt;version=&lt;quote&gt;1.0&lt;quote&gt;&lt;space&gt;encoding=&lt;quote&gt;US_ASCII&lt;quote&gt;&lt;space&gt;standalone=&lt;quote&gt;no&lt;quote&gt;&lt;space&gt;?&lt;gt&gt;&lt;lt&gt;geometry&lt;space&gt;dimension=&lt;quote&gt;2&lt;quote&gt;&lt;gt&gt;&lt;lt&gt;null&lt;solidus&gt;&lt;gt&gt;&lt;lt&gt;&lt;solidus&gt;geometry&lt;gt&gt;"/>
#! <XFORM_PARM PARM_NAME="GEOMTYPE" PARM_VALUE="Geometry Object"/>
#! <XFORM_PARM PARM_NAME="COORDSYS" PARM_VALUE=""/>
#! <XFORM_PARM PARM_NAME="ATEND" PARM_VALUE="no"/>
#! <XFORM_PARM PARM_NAME="NUM" PARM_VALUE="1"/>
#! <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="Creator"/>
#! <XFORM_PARM PARM_NAME="PARAMETERS_GROUP" PARM_VALUE=""/>
#! </TRANSFORMER>
#! <TRANSFORMER
#! IDENTIFIER="4"
#! TYPE="Reprojector"
#! VERSION="4"
#! POSITION="1865.03 -120.085"
#! BOUNDING_RECT="1865.03 -120.085 -1 -1"
#! ORDER="5e+014"
#! PARMS_EDITED="false"
#! ENABLED="true"
#! LAST_PARM_EDIT="15208"
#! >
#! <OUTPUT_FEAT NAME="REPROJECTED"/>
#! <FEAT_COLLAPSED COLLAPSED="0"/>
#! <XFORM_ATTR ATTR_NAME="feature_id" IS_USER_CREATED="false" FEAT_INDEX="0" />
#! <XFORM_PARM PARM_NAME="TRANSFORMER_GROUP" PARM_VALUE=""/>
#! <XFORM_PARM PARM_NAME="INTERPOLATION_TYPE_NAME" PARM_VALUE="Nearest Neighbor"/>
#! <XFORM_PARM PARM_NAME="SOURCE" PARM_VALUE="Read from feature"/>
#! <XFORM_PARM PARM_NAME="RASTER_CELL_SIZE" PARM_VALUE="Preserve Cells"/>
#! <XFORM_PARM PARM_NAME="DEST" PARM_VALUE="EPSG:4326"/>
#! <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="Reprojector"/>
#! <XFORM_PARM PARM_NAME="PARAMETERS_GROUP" PARM_VALUE=""/>
#! </TRANSFORMER>
#! <TRANSFORMER
#! IDENTIFIER="5"
#! TYPE="GeometryExtractor"
#! VERSION="8"
#! POSITION="1865.03 -318.003"
#! BOUNDING_RECT="1865.03 -318.003 -1 -1"
#! ORDER="5e+014"
#! PARMS_EDITED="false"
#! ENABLED="true"
#! LAST_PARM_EDIT="15208"
#! >
#! <OUTPUT_FEAT NAME="OUTPUT"/>
#! <FEAT_COLLAPSED COLLAPSED="0"/>
#! <XFORM_ATTR ATTR_NAME="feature_id" IS_USER_CREATED="false" FEAT_INDEX="0" />
#! <XFORM_ATTR ATTR_NAME="_geometryupdated" IS_USER_CREATED="false" FEAT_INDEX="0" />
#! <XFORM_PARM PARM_NAME="TRANSFORMER_GROUP" PARM_VALUE=""/>
#! <XFORM_PARM PARM_NAME="PRECISION" PARM_VALUE="&lt;Unused&gt;"/>
#! <XFORM_PARM PARM_NAME="ATTR" PARM_VALUE="_geometryupdated"/>
#! <XFORM_PARM PARM_NAME="KIND_LONG" PARM_VALUE="GeoJSON"/>
#! <XFORM_PARM PARM_NAME="OGEOSMS_URL_PREFIX" PARM_VALUE="&lt;Unused&gt;"/>
#! <XFORM_PARM PARM_NAME="OGCVERSION" PARM_VALUE="&lt;Unused&gt;"/>
#! <XFORM_PARM PARM_NAME="ELLIPSOID_NAME" PARM_VALUE="&lt;Unused&gt;"/>
#! <XFORM_PARM PARM_NAME="GEOHASH_PRECISION_DISPLAY" PARM_VALUE="&lt;Unused&gt;"/>
#! <XFORM_PARM PARM_NAME="LETTERING" PARM_VALUE="&lt;Unused&gt;"/>
#! <XFORM_PARM PARM_NAME="LEVELS_ATTR" PARM_VALUE="&lt;Unused&gt;"/>
#! <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="GeometryExtractor"/>
#! <XFORM_PARM PARM_NAME="PARAMETERS_GROUP" PARM_VALUE=""/>
#! <XFORM_PARM PARM_NAME="OMIT_NAMESPACES_DISPLAY" PARM_VALUE="&lt;Unused&gt;"/>
#! </TRANSFORMER>
#! <TRANSFORMER
#! IDENTIFIER="6"
#! TYPE="ParameterFetcher"
#! VERSION="4"
#! POSITION="1865.03 -519.005"
#! BOUNDING_RECT="1865.03 -519.005 -1 -1"
#! ORDER="5e+014"
#! PARMS_EDITED="false"
#! ENABLED="true"
#! LAST_PARM_EDIT="15208"
#! >
#! <OUTPUT_FEAT NAME="OUTPUT"/>
#! <FEAT_COLLAPSED COLLAPSED="0"/>
#! <XFORM_ATTR ATTR_NAME="feature_id" IS_USER_CREATED="false" FEAT_INDEX="0" />
#! <XFORM_ATTR ATTR_NAME="_geometryupdated" IS_USER_CREATED="false" FEAT_INDEX="0" />
#! <XFORM_ATTR ATTR_NAME="_type" IS_USER_CREATED="false" FEAT_INDEX="0" />
#! <XFORM_PARM PARM_NAME="ATTR_LIST" PARM_VALUE="_type {$(type)}"/>
#! <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="ParameterFetcher"/>
#! </TRANSFORMER>
#! <TRANSFORMER
#! IDENTIFIER="7"
#! TYPE="StringConcatenator"
#! VERSION="7"
#! POSITION="2434.04 -120.085"
#! BOUNDING_RECT="2434.04 -120.085 -1 -1"
#! ORDER="5e+014"
#! PARMS_EDITED="false"
#! ENABLED="true"
#! LAST_PARM_EDIT="15208"
#! >
#! <OUTPUT_FEAT NAME="OUTPUT"/>
#! <FEAT_COLLAPSED COLLAPSED="0"/>
#! <XFORM_ATTR ATTR_NAME="feature_id" IS_USER_CREATED="false" FEAT_INDEX="0" />
#! <XFORM_ATTR ATTR_NAME="_geometryupdated" IS_USER_CREATED="false" FEAT_INDEX="0" />
#! <XFORM_ATTR ATTR_NAME="_type" IS_USER_CREATED="false" FEAT_INDEX="0" />
#! <XFORM_ATTR ATTR_NAME="message" IS_USER_CREATED="false" FEAT_INDEX="0" />
#! <XFORM_PARM PARM_NAME="TRANSFORMER_GROUP" PARM_VALUE=""/>
#! <XFORM_PARM PARM_NAME="VAL_ATTR" PARM_VALUE="message"/>
#! <XFORM_PARM PARM_NAME="PARAM_GROUP" PARM_VALUE=""/>
#! <XFORM_PARM PARM_NAME="PARM_LINE" PARM_VALUE="&lt;opencurly&gt;&lt;quote&gt;id&lt;quote&gt;&lt;space&gt;:&lt;space&gt;&lt;quote&gt;&lt;at&gt;Value&lt;openparen&gt;feature_id&lt;closeparen&gt;&lt;quote&gt;&lt;comma&gt;&lt;quote&gt;type&lt;quote&gt;:&lt;space&gt;&lt;quote&gt;&lt;at&gt;Value&lt;openparen&gt;_type&lt;closeparen&gt;&lt;quote&gt;&lt;comma&gt;&lt;quote&gt;features&lt;quote&gt;&lt;space&gt;:&lt;space&gt;&lt;openbracket&gt;&lt;space&gt;&lt;at&gt;Value&lt;openparen&gt;_geometryupdated&lt;closeparen&gt;&lt;closebracket&gt;&lt;closecurly&gt;"/>
#! <XFORM_PARM PARM_NAME="ACTION" PARM_VALUE="Create New Attribute"/>
#! <XFORM_PARM PARM_NAME="ATTRLIST" PARM_VALUE="&lt;Unused&gt;"/>
#! <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="StringConcatenator"/>
#! </TRANSFORMER>
#! <TRANSFORMER
#! IDENTIFIER="8"
#! TYPE="Decelerator"
#! VERSION="0"
#! POSITION="2434.04 -318.003"
#! BOUNDING_RECT="2434.04 -318.003 -1 -1"
#! ORDER="5e+014"
#! PARMS_EDITED="false"
#! ENABLED="true"
#! LAST_PARM_EDIT="15208"
#! >
#! <OUTPUT_FEAT NAME="OUTPUT"/>
#! <FEAT_COLLAPSED COLLAPSED="0"/>
#! <XFORM_ATTR ATTR_NAME="feature_id" IS_USER_CREATED="false" FEAT_INDEX="0" />
#! <XFORM_ATTR ATTR_NAME="_geometryupdated" IS_USER_CREATED="false" FEAT_INDEX="0" />
#! <XFORM_ATTR ATTR_NAME="_type" IS_USER_CREATED="false" FEAT_INDEX="0" />
#! <XFORM_ATTR ATTR_NAME="message" IS_USER_CREATED="false" FEAT_INDEX="0" />
#! <XFORM_PARM PARM_NAME="TRANSFORMER_GROUP" PARM_VALUE=""/>
#! <XFORM_PARM PARM_NAME="DELAY" PARM_VALUE="0.01"/>
#! <XFORM_PARM PARM_NAME="FEATURES_PER_SECOND" PARM_VALUE="&lt;Unused&gt;"/>
#! <XFORM_PARM PARM_NAME="DECEL_TYPE" PARM_VALUE="Per Feature Delay"/>
#! <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="Decelerator"/>
#! <XFORM_PARM PARM_NAME="PARAMETERS_GROUP" PARM_VALUE=""/>
#! </TRANSFORMER>
#! <TRANSFORMER
#! IDENTIFIER="9"
#! TYPE="WebSocketSender"
#! VERSION="1"
#! POSITION="2434.04 -519.005"
#! BOUNDING_RECT="2434.04 -519.005 -1 -1"
#! ORDER="5e+014"
#! PARMS_EDITED="true"
#! ENABLED="true"
#! LAST_PARM_EDIT="15208"
#! >
#! <OUTPUT_FEAT NAME="OUTPUT"/>
#! <FEAT_COLLAPSED COLLAPSED="0"/>
#! <XFORM_ATTR ATTR_NAME="feature_id" IS_USER_CREATED="false" FEAT_INDEX="0" />
#! <XFORM_ATTR ATTR_NAME="_geometryupdated" IS_USER_CREATED="false" FEAT_INDEX="0" />
#! <XFORM_ATTR ATTR_NAME="_type" IS_USER_CREATED="false" FEAT_INDEX="0" />
#! <XFORM_ATTR ATTR_NAME="message" IS_USER_CREATED="false" FEAT_INDEX="0" />
#! <XFORM_PARM PARM_NAME="TRANSFORMER_GROUP" PARM_VALUE=""/>
#! <XFORM_PARM PARM_NAME="VERIFY_SSL_CERTIFICATES" PARM_VALUE="Yes"/>
#! <XFORM_PARM PARM_NAME="PREAMBLE" PARM_VALUE="&lt;opencurly&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;ws_op&lt;quote&gt;:&lt;space&gt;&lt;quote&gt;open&lt;quote&gt;&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;ws_stream_id&lt;quote&gt;:&lt;space&gt;&lt;quote&gt;cadqa&lt;quote&gt;&lt;lf&gt;&lt;closecurly&gt;"/>
#! <XFORM_PARM PARM_NAME="DATA" PARM_VALUE="&lt;opencurly&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;ws_op&lt;apos&gt;:&lt;space&gt;&lt;apos&gt;send&lt;apos&gt;&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;ws_msg&lt;apos&gt;:&lt;space&gt;&lt;apos&gt;&lt;at&gt;Value&lt;openparen&gt;message&lt;closeparen&gt;&lt;apos&gt;&lt;lf&gt;&lt;closecurly&gt;"/>
#! <XFORM_PARM PARM_NAME="HOST" PARM_VALUE="$(WEBSOCKET_URL)"/>
#! <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="WebSocketSender"/>
#! <XFORM_PARM PARM_NAME="PARAMETERS_GROUP" PARM_VALUE=""/>
#! </TRANSFORMER>
#! </TRANSFORMERS>
#! <FEAT_LINKS>
#! <FEAT_LINK
#! IDENTIFIER="3"
#! SOURCE_NODE="2"
#! TARGET_NODE="18"
#! SOURCE_PORT_DESC="fo 0"
#! TARGET_PORT_DESC="fi 0"
#! ENABLED="true"
#! EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#! IDENTIFIER="10"
#! SOURCE_NODE="4"
#! TARGET_NODE="5"
#! SOURCE_PORT_DESC="fo 0"
#! TARGET_PORT_DESC="fi 0"
#! ENABLED="true"
#! EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#! IDENTIFIER="11"
#! SOURCE_NODE="5"
#! TARGET_NODE="6"
#! SOURCE_PORT_DESC="fo 0"
#! TARGET_PORT_DESC="fi 0"
#! ENABLED="true"
#! EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#! IDENTIFIER="12"
#! SOURCE_NODE="6"
#! TARGET_NODE="7"
#! SOURCE_PORT_DESC="fo 0"
#! TARGET_PORT_DESC="fi 0"
#! ENABLED="true"
#! EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#! IDENTIFIER="13"
#! SOURCE_NODE="7"
#! TARGET_NODE="8"
#! SOURCE_PORT_DESC="fo 0"
#! TARGET_PORT_DESC="fi 0"
#! ENABLED="true"
#! EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#! IDENTIFIER="14"
#! SOURCE_NODE="8"
#! TARGET_NODE="9"
#! SOURCE_PORT_DESC="fo 0"
#! TARGET_PORT_DESC="fi 0"
#! ENABLED="true"
#! EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#! IDENTIFIER="15"
#! SOURCE_NODE="18"
#! TARGET_NODE="4"
#! SOURCE_PORT_DESC="fo 0"
#! TARGET_PORT_DESC="fi 0"
#! ENABLED="true"
#! EXTRA_POINTS=""
#! />
#! </FEAT_LINKS>
#! <BREAKPOINTS>
#! </BREAKPOINTS>
#! <ATTR_LINKS>
#! </ATTR_LINKS>
#! <SUBDOCUMENTS>
#! <SUBDOCUMENT
#! NAME="DatabaseQueryLooper"
#! VIEW_POSITION="-2622.03 90.0009"
#! FME_PROCESS_GROUP_BY=""
#! REQUIREMENTS=""
#! SUPPRESS_UPGRADE="false"
#! XFORM_DEPRECATED="No"
#! DOC_DYNAMIC_INPUT_ATTRS="0"
#! HISTORY=""
#! FME_DOCUMENT_PRIORGUID=""
#! DOC_TOP_LEFT="-2631.03 -1470.01"
#! DOC_EXTENTS="3263.04 1400.76"
#! IS_VISIBLE="true"
#! FME_DOCUMENT_GUID=""
#! ZOOM_SCALE="100"
#! FME_PROCESS_GROUPS_ORDERED="No"
#! USAGE=""
#! TITLE="DatabaseQueryLooper"
#! DESCRIPTION=""
#! FME_PROCESS_COUNT="NO_PARALLELISM"
#! REQUIREMENTS_KEYWORD=""
#! LEGAL_TERMS_CONDITIONS=""
#! CATEGORY=""
#! >
#! <GLOBAL_PARAMETERS>
#! <GLOBAL_PARAMETER
#! GUI_LINE="GUI OPTIONAL TEXT_OR_ATTR type Type:"
#! DEFAULT_VALUE="i"
#! IS_STAND_ALONE="true"
#! />
#! <GLOBAL_PARAMETER
#! GUI_LINE="GUI OPTIONAL INTEGER_OR_ATTR minID Minimum ID:"
#! DEFAULT_VALUE="1"
#! IS_STAND_ALONE="true"
#! />
#! <GLOBAL_PARAMETER
#! GUI_LINE="GUI OPTIONAL INTEGER_OR_ATTR maxID Maximum ID:"
#! DEFAULT_VALUE="300"
#! IS_STAND_ALONE="true"
#! />
#! </GLOBAL_PARAMETERS>
#! <COMMENTS>
#! </COMMENTS>
#! <CONSTANTS>
#! </CONSTANTS>
#! <BOOKMARKS>
#! </BOOKMARKS>
#! <TRANSFORMERS>
#! <TRANSFORMER
#! IDENTIFIER="21"
#! TYPE="SQLExecutor"
#! VERSION="6"
#! POSITION="-1921 -867.508"
#! BOUNDING_RECT="-1921 -867.508 -1 -1"
#! ORDER="5e+014"
#! PARMS_EDITED="true"
#! ENABLED="true"
#! LAST_PARM_EDIT="15208"
#! >
#! <OUTPUT_FEAT NAME="RESULT"/>
#! <FEAT_COLLAPSED COLLAPSED="0"/>
#! <XFORM_ATTR ATTR_NAME="feature_id" IS_USER_CREATED="false" FEAT_INDEX="0" />
#! <OUTPUT_FEAT NAME="INITIATOR"/>
#! <FEAT_COLLAPSED COLLAPSED="1"/>
#! <XFORM_ATTR ATTR_NAME="_featuresRetrieved" IS_USER_CREATED="false" FEAT_INDEX="1" />
#! <XFORM_ATTR ATTR_NAME="_matched_records" IS_USER_CREATED="false" FEAT_INDEX="1" />
#! <XFORM_ATTR ATTR_NAME="_count" IS_USER_CREATED="false" FEAT_INDEX="1" />
#! <XFORM_PARM PARM_NAME="POSTGIS_HOST" PARM_VALUE="my-postgis-server"/>
#! <XFORM_PARM PARM_NAME="EXPOSED_ATTRIBUTE_LIST" PARM_VALUE="feature_id"/>
#! <XFORM_PARM PARM_NAME="DATASET" PARM_VALUE="FME_EXPOSE:HOST|my-postgis-server|PORT|5432|DATASET|gisdb|USER_NAME|dbuser|PASSWORD|fme_decrypt&lt;openparen&gt;MDowfCN8I3xcG3GQ&lt;solidus&gt;TeRRUJUZ5LDPtdvpscbh7Nj9gG&lt;solidus&gt;INBkAGA+fkaDrNbhZtfa3rmkUUrCxKWaAFwiYsKgWJNl&lt;solidus&gt;0mRpxUuP+IT2c+Qhh26JEZtUWAmpuoaQCdQ3ykKWm2zaoAM5MBCGaGEuYe+6AS07&lt;solidus&gt;nLNRJwqp1jdwP1FgVCbXRvZtWfKjEZlNJYQ+EicVc6cv2DxCYJyTljvXwF8mKxenML6FKJiHARQCO8OMJidKKZQJP1SeYIhqB0YrtGw4cGV2ZquQKifvRjB2Tl6wBAWDmeCg+R1jvft1tR17SISyTDv77K+mV80w2aaUSgybbF7coM0BrQPcpehfjlW+YxV73+9mPMFXKQeznZ22T8MJor57O44p8U2NQCw35HiFBs0oVP9VkkY0D&lt;solidus&gt;WzGRevseyX1pIEWJSQSFwkJVhiyXavMDz5E5SEYgTZHfVeGBXCDuIEEbfRRkPU5yD2nw2ZAVimDRD7UQhEEY6PosGqU17He4y35WEfAggQ40+EKuupOQSZRsKotTTqlYGHJtX49ymuKqfyZzOAUSUzDMcj8gfDgzOCcuhw2sK3fJaMszmgnHpD4eJYzNVdHTpDgZ5Cw+ILkMEVbZMrkzbe8VmSS2V+p08BDoAwg4C36fPyEESja7hBskTu2XrfYwjTHRbvi2TsfCwaRI&lt;solidus&gt;UGka5Qi+i8tagXLieFL8UAZsAtqP+iQeoaM3YOsc&lt;solidus&gt;AMAot9WMyqV+CyAYGPCTdeCq7Y3rQ9dQGQFR0samdxZuW&lt;solidus&gt;+Q6blJgOzo27GMpdk&lt;solidus&gt;Rddz5mTJVbf16HhFmt2ASRy2B20Hg6Sew8puaXCf&lt;solidus&gt;OsCSbIQ4j+ZRpyGsHGCCVugN4VUaeSagaRvNa9m&lt;solidus&gt;1cG&lt;solidus&gt;i4Jalgu6y1LoW2kxTRyuDrJF1wqdF1smOJ+YCu6oWHcorJXN43iHJCE8seTd9T5kC&lt;closeparen&gt;"/>
#! <XFORM_PARM PARM_NAME="FORMAT" PARM_VALUE="POSTGIS"/>
#! <XFORM_PARM PARM_NAME="SQL_STATEMENT" PARM_VALUE="SELECT&lt;space&gt;*&lt;space&gt;FROM&lt;space&gt;cad_qa.&lt;quote&gt;WATERLINES&lt;quote&gt;&lt;space&gt;AS&lt;space&gt;w&lt;comma&gt;&lt;space&gt;cad_qa.temp_ids&lt;space&gt;AS&lt;space&gt;t&lt;lf&gt;WHERE&lt;space&gt;&lt;space&gt;w.primaryindex&lt;space&gt;=&lt;space&gt;t.primaryindex&lt;lf&gt;AND&lt;space&gt;t.primaryindex&lt;space&gt;BETWEEN&lt;space&gt;$(minID)&lt;space&gt;AND&lt;space&gt;$(maxID)&lt;semicolon&gt;"/>
#! <XFORM_PARM PARM_NAME="FORMAT_PARAMS" PARM_VALUE="POSTGIS_PORT,&quot;OPTIONAL INTEGER&quot;,POSTGIS&lt;space&gt;Port:,POSTGIS_USER_NAME,&quot;OPTIONAL TEXT&quot;,POSTGIS&lt;space&gt;Username:,POSTGIS_HOST,&quot;OPTIONAL TEXT&quot;,POSTGIS&lt;space&gt;Host:,POSTGIS_PASSWORD,&quot;OPTIONAL PASSWORD&quot;,POSTGIS&lt;space&gt;Password:"/>
#! <XFORM_PARM PARM_NAME="POSTGIS_PASSWORD" PARM_VALUE="fme_decrypt(MDowfCN8I3xcG3GQ/TeRRUJUZ5LDPtdvpscbh7Nj9gG/INBkAGA+fkaDrNbhZtfa3rmkUUrCxKWaAFwiYsKgWJNl/0mRpxUuP+IT2c+Qhh26JEZtUWAmpuoaQCdQ3ykKWm2zaoAM5MBCGaGEuYe+6AS07/nLNRJwqp1jdwP1FgVCbXRvZtWfKjEZlNJYQ+EicVc6cv2DxCYJyTljvXwF8mKxenML6FKJiHARQCO8OMJidKKZQJP1SeYIhqB0YrtGw4cGV2ZquQKifvRjB2Tl6wBAWDmeCg+R1jvft1tR17SISyTDv77K+mV80w2aaUSgybbF7coM0BrQPcpehfjlW+YxV73+9mPMFXKQeznZ22T8MJor57O44p8U2NQCw35HiFBs0oVP9VkkY0D/WzGRevseyX1pIEWJSQSFwkJVhiyXavMDz5E5SEYgTZHfVeGBXCDuIEEbfRRkPU5yD2nw2ZAVimDRD7UQhEEY6PosGqU17He4y35WEfAggQ40+EKuupOQSZRsKotTTqlYGHJtX49ymuKqfyZzOAUSUzDMcj8gfDgzOCcuhw2sK3fJaMszmgnHpD4eJYzNVdHTpDgZ5Cw+ILkMEVbZMrkzbe8VmSS2V+p08BDoAwg4C36fPyEESja7hBskTu2XrfYwjTHRbvi2TsfCwaRI/UGka5Qi+i8tagXLieFL8UAZsAtqP+iQeoaM3YOsc/AMAot9WMyqV+CyAYGPCTdeCq7Y3rQ9dQGQFR0samdxZuW/+Q6blJgOzo27GMpdk/Rddz5mTJVbf16HhFmt2ASRy2B20Hg6Sew8puaXCf/OsCSbIQ4j+ZRpyGsHGCCVugN4VUaeSagaRvNa9m/1cG/i4Jalgu6y1LoW2kxTRyuDrJF1wqdF1smOJ+YCu6oWHcorJXN43iHJCE8seTd9T5kC)"/>
#! <XFORM_PARM PARM_NAME="COMBINE_GEOM" PARM_VALUE="Result Geometry Only"/>
#! <XFORM_PARM PARM_NAME="POSTGIS_USER_NAME" PARM_VALUE="dbuser"/>
#! <XFORM_PARM PARM_NAME="COMBINE_ATTRS" PARM_VALUE="Result Attributes Only"/>
#! <XFORM_PARM PARM_NAME="POSTGIS_PORT" PARM_VALUE="5432"/>
#! <XFORM_PARM PARM_NAME="COORDSYS" PARM_VALUE=""/>
#! <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="SQLExecutor_2"/>
#! <XFORM_PARM PARM_NAME="PARAMETERS_GROUP" PARM_VALUE=""/>
#! </TRANSFORMER>
#! <TRANSFORMER
#! IDENTIFIER="29"
#! TYPE="Counter"
#! VERSION="2"
#! POSITION="-1352 -1470.01"
#! BOUNDING_RECT="-1352 -1470.01 -1 -1"
#! ORDER="5e+014"
#! PARMS_EDITED="true"
#! ENABLED="true"
#! LAST_PARM_EDIT="15208"
#! >
#! <OUTPUT_FEAT NAME="OUTPUT"/>
#! <FEAT_COLLAPSED COLLAPSED="0"/>
#! <XFORM_ATTR ATTR_NAME="_featuresRetrieved" IS_USER_CREATED="false" FEAT_INDEX="0" />
#! <XFORM_ATTR ATTR_NAME="_matched_records" IS_USER_CREATED="false" FEAT_INDEX="0" />
#! <XFORM_ATTR ATTR_NAME="_count" IS_USER_CREATED="false" FEAT_INDEX="0" />
#! <XFORM_PARM PARM_NAME="TRANSFORMER_GROUP" PARM_VALUE=""/>
#! <XFORM_PARM PARM_NAME="CNT_ATTR" PARM_VALUE="_count"/>
#! <XFORM_PARM PARM_NAME="SCOPE" PARM_VALUE="Global"/>
#! <XFORM_PARM PARM_NAME="START" PARM_VALUE="0"/>
#! <XFORM_PARM PARM_NAME="DOMAIN" PARM_VALUE="counter"/>
#! <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="Counter"/>
#! <XFORM_PARM PARM_NAME="PARAMETERS_GROUP" PARM_VALUE=""/>
#! </TRANSFORMER>
#! <TRANSFORMER
#! IDENTIFIER="32"
#! TYPE="Decelerator"
#! VERSION="0"
#! POSITION="-1942 -636.507"
#! BOUNDING_RECT="-1942 -636.507 -1 -1"
#! ORDER="5e+014"
#! PARMS_EDITED="true"
#! ENABLED="true"
#! LAST_PARM_EDIT="15208"
#! >
#! <OUTPUT_FEAT NAME="OUTPUT"/>
#! <FEAT_COLLAPSED COLLAPSED="0"/>
#! <XFORM_ATTR ATTR_NAME="_featuresRetrieved" IS_USER_CREATED="false" FEAT_INDEX="0" />
#! <XFORM_ATTR ATTR_NAME="_matched_records" IS_USER_CREATED="false" FEAT_INDEX="0" />
#! <XFORM_ATTR ATTR_NAME="_count" IS_USER_CREATED="false" FEAT_INDEX="0" />
#! <XFORM_PARM PARM_NAME="TRANSFORMER_GROUP" PARM_VALUE=""/>
#! <XFORM_PARM PARM_NAME="DELAY" PARM_VALUE="1"/>
#! <XFORM_PARM PARM_NAME="FEATURES_PER_SECOND" PARM_VALUE="&lt;Unused&gt;"/>
#! <XFORM_PARM PARM_NAME="DECEL_TYPE" PARM_VALUE="Per Feature Delay"/>
#! <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="Decelerator_2"/>
#! <XFORM_PARM PARM_NAME="PARAMETERS_GROUP" PARM_VALUE=""/>
#! </TRANSFORMER>
#! <TRANSFORMER
#! IDENTIFIER="19"
#! TYPE="Sampler"
#! VERSION="1"
#! POSITION="-1352 -1098.51"
#! BOUNDING_RECT="-1352 -1098.51 -1 -1"
#! ORDER="5e+014"
#! PARMS_EDITED="true"
#! ENABLED="true"
#! LAST_PARM_EDIT="15208"
#! >
#! <OUTPUT_FEAT NAME="SAMPLED"/>
#! <FEAT_COLLAPSED COLLAPSED="0"/>
#! <XFORM_ATTR ATTR_NAME="feature_id" IS_USER_CREATED="false" FEAT_INDEX="0" />
#! <OUTPUT_FEAT NAME="NOT_SAMPLED"/>
#! <FEAT_COLLAPSED COLLAPSED="1"/>
#! <XFORM_ATTR ATTR_NAME="feature_id" IS_USER_CREATED="false" FEAT_INDEX="1" />
#! <XFORM_PARM PARM_NAME="TRANSFORMER_GROUP" PARM_VALUE=""/>
#! <XFORM_PARM PARM_NAME="GROUP_BY" PARM_VALUE=""/>
#! <XFORM_PARM PARM_NAME="SAMPLE_TYPE_LONG" PARM_VALUE="First N Features"/>
#! <XFORM_PARM PARM_NAME="FME_PROCESS_GROUPS_ORDERED" PARM_VALUE="No"/>
#! <XFORM_PARM PARM_NAME="RATE" PARM_VALUE="1"/>
#! <XFORM_PARM PARM_NAME="FME_PROCESS_COUNTDISP" PARM_VALUE="No Parallelism"/>
#! <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="Sampler"/>
#! <XFORM_PARM PARM_NAME="PARAMETERS_GROUP" PARM_VALUE=""/>
#! </TRANSFORMER>
#! <TRANSFORMER
#! IDENTIFIER="36"
#! TYPE="VariableRetriever"
#! VERSION="3"
#! POSITION="-1942 -200.753"
#! BOUNDING_RECT="-1942 -200.753 -1 -1"
#! ORDER="5e+014"
#! PARMS_EDITED="true"
#! ENABLED="true"
#! LAST_PARM_EDIT="15208"
#! >
#! <OUTPUT_FEAT NAME="OUTPUT"/>
#! <FEAT_COLLAPSED COLLAPSED="0"/>
#! <XFORM_ATTR ATTR_NAME="_featuresRetrieved" IS_USER_CREATED="false" FEAT_INDEX="0" />
#! <XFORM_ATTR ATTR_NAME="_matched_records" IS_USER_CREATED="false" FEAT_INDEX="0" />
#! <XFORM_ATTR ATTR_NAME="_count" IS_USER_CREATED="false" FEAT_INDEX="0" />
#! <XFORM_PARM PARM_NAME="TRANSFORMER_GROUP" PARM_VALUE=""/>
#! <XFORM_PARM PARM_NAME="VALUE_ATTR" PARM_VALUE="_featuresRetrieved"/>
#! <XFORM_PARM PARM_NAME="PARAMETER_GROUP" PARM_VALUE=""/>
#! <XFORM_PARM PARM_NAME="SCOPE" PARM_VALUE="Global"/>
#! <XFORM_PARM PARM_NAME="VARNAME" PARM_VALUE="featuresRetrieved"/>
#! <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="VariableRetriever"/>
#! </TRANSFORMER>
#! <TRANSFORMER
#! IDENTIFIER="34"
#! TYPE="Tester"
#! VERSION="2"
#! POSITION="-1942 -404.753"
#! BOUNDING_RECT="-1942 -404.753 -1 -1"
#! ORDER="5e+014"
#! PARMS_EDITED="true"
#! ENABLED="true"
#! LAST_PARM_EDIT="15208"
#! >
#! <OUTPUT_FEAT NAME="PASSED"/>
#! <FEAT_COLLAPSED COLLAPSED="0"/>
#! <XFORM_ATTR ATTR_NAME="_featuresRetrieved" IS_USER_CREATED="false" FEAT_INDEX="0" />
#! <XFORM_ATTR ATTR_NAME="_matched_records" IS_USER_CREATED="false" FEAT_INDEX="0" />
#! <XFORM_ATTR ATTR_NAME="_count" IS_USER_CREATED="false" FEAT_INDEX="0" />
#! <OUTPUT_FEAT NAME="FAILED"/>
#! <FEAT_COLLAPSED COLLAPSED="1"/>
#! <XFORM_ATTR ATTR_NAME="_featuresRetrieved" IS_USER_CREATED="false" FEAT_INDEX="1" />
#! <XFORM_ATTR ATTR_NAME="_matched_records" IS_USER_CREATED="false" FEAT_INDEX="1" />
#! <XFORM_ATTR ATTR_NAME="_count" IS_USER_CREATED="false" FEAT_INDEX="1" />
#! <XFORM_PARM PARM_NAME="TEST_LIST" PARM_VALUE=""/>
#! <XFORM_PARM PARM_NAME="BOOL_OP" PARM_VALUE="AND"/>
#! <XFORM_PARM PARM_NAME="TEST_CLAUSE" PARM_VALUE="TEST &lt;at&gt;Value&lt;openparen&gt;_count&lt;closeparen&gt; &lt;= 15&#10;TEST &lt;at&gt;Value&lt;openparen&gt;_featuresRetrieved&lt;closeparen&gt; != true"/>
#! <XFORM_PARM PARM_NAME="TEST_MODE" PARM_VALUE="Automatic"/>
#! <XFORM_PARM PARM_NAME="COMPOSITE_TEST" PARM_VALUE="&lt;Unused&gt;"/>
#! <XFORM_PARM PARM_NAME="TEST_DESCRIPTION" PARM_VALUE="&quot;&quot;"/>
#! <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="Tester"/>
#! </TRANSFORMER>
#! <TRANSFORMER
#! IDENTIFIER="42"
#! TYPE="SQLExecutor"
#! VERSION="6"
#! POSITION="-761.997 -867.508"
#! BOUNDING_RECT="-761.997 -867.508 -1 -1"
#! ORDER="5e+014"
#! PARMS_EDITED="true"
#! ENABLED="true"
#! LAST_PARM_EDIT="15208"
#! >
#! <OUTPUT_FEAT NAME="RESULT"/>
#! <FEAT_COLLAPSED COLLAPSED="0"/>
#! <OUTPUT_FEAT NAME="INITIATOR"/>
#! <FEAT_COLLAPSED COLLAPSED="1"/>
#! <XFORM_ATTR ATTR_NAME="feature_id" IS_USER_CREATED="false" FEAT_INDEX="1" />
#! <XFORM_ATTR ATTR_NAME="_matched_records" IS_USER_CREATED="false" FEAT_INDEX="1" />
#! <XFORM_PARM PARM_NAME="POSTGIS_HOST" PARM_VALUE="my-postgis-server"/>
#! <XFORM_PARM PARM_NAME="EXPOSED_ATTRIBUTE_LIST" PARM_VALUE=""/>
#! <XFORM_PARM PARM_NAME="DATASET" PARM_VALUE="FME_EXPOSE:HOST|my-postgis-server|PORT|5432|DATASET|gisdb|USER_NAME|dbuser|PASSWORD|fme_decrypt&lt;openparen&gt;MDowfCN8I3xcG3GQ&lt;solidus&gt;TeRRUJUZ5LDPtdvpscbh7Nj9gG&lt;solidus&gt;INBkAGA+fkaDrNbhZtfa3rmkUUrCxKWaAFwiYsKgWJNl&lt;solidus&gt;0mRpxUuP+IT2c+Qhh26JEZtUWAmpuoaQCdQ3ykKWm2zaoAM5MBCGaGEuYe+6AS07&lt;solidus&gt;nLNRJwqp1jdwP1FgVCbXRvZtWfKjEZlNJYQ+EicVc6cv2DxCYJyTljvXwF8mKxenML6FKJiHARQCO8OMJidKKZQJP1SeYIhqB0YrtGw4cGV2ZquQKifvRjB2Tl6wBAWDmeCg+R1jvft1tR17SISyTDv77K+mV80w2aaUSgybbF7coM0BrQPcpehfjlW+YxV73+9mPMFXKQeznZ22T8MJor57O44p8U2NQCw35HiFBs0oVP9VkkY0D&lt;solidus&gt;WzGRevseyX1pIEWJSQSFwkJVhiyXavMDz5E5SEYgTZHfVeGBXCDuIEEbfRRkPU5yD2nw2ZAVimDRD7UQhEEY6PosGqU17He4y35WEfAggQ40+EKuupOQSZRsKotTTqlYGHJtX49ymuKqfyZzOAUSUzDMcj8gfDgzOCcuhw2sK3fJaMszKUbJMWISROKpBFzD1UxTc+EBd1DL9t2tz0xwRLKTTCoszZ3kLriRuxVc5YfyJNgxteACAxbN7Q7D22cf4NQH+fPOggAMLhs+dVfYmmW+zeIoHMA8V6Z6J2yVs7WLFUpLIrIojgPKZf9cPtwLfRraxagCmk18Gidl30o5j036klmIXjt9lZMVtUj8JMkvoYP23NRxGqhU0Is1EgXaZWxR3SDg35znI87QKmqBDfjJEo0kdIjJCWrk8WOECvWpgW+d005fCyhpB372NFk3VyCjdI1&lt;solidus&gt;FcMNaCQRXVZh&lt;solidus&gt;p3&lt;solidus&gt;FF&lt;solidus&gt;NKr4K+g01bt7ONRhkqXr77K&lt;solidus&gt;OR+qp8aX7fvkQM5e+YH+1h7sk2E3Q&lt;closeparen&gt;"/>
#! <XFORM_PARM PARM_NAME="FORMAT" PARM_VALUE="POSTGIS"/>
#! <XFORM_PARM PARM_NAME="SQL_STATEMENT" PARM_VALUE="DELETE&lt;space&gt;FROM&lt;space&gt;cad_qa.temp_ids&lt;space&gt;WHERE&lt;space&gt;primaryindex&lt;space&gt;BETWEEN&lt;space&gt;$(minID)&lt;space&gt;AND&lt;space&gt;$(maxID)"/>
#! <XFORM_PARM PARM_NAME="FORMAT_PARAMS" PARM_VALUE="POSTGIS_PORT,&quot;OPTIONAL INTEGER&quot;,POSTGIS&lt;space&gt;Port:,POSTGIS_USER_NAME,&quot;OPTIONAL TEXT&quot;,POSTGIS&lt;space&gt;Username:,POSTGIS_HOST,&quot;OPTIONAL TEXT&quot;,POSTGIS&lt;space&gt;Host:,POSTGIS_PASSWORD,&quot;OPTIONAL PASSWORD&quot;,POSTGIS&lt;space&gt;Password:"/>
#! <XFORM_PARM PARM_NAME="POSTGIS_PASSWORD" PARM_VALUE="fme_decrypt(MDowfCN8I3xcG3GQ/TeRRUJUZ5LDPtdvpscbh7Nj9gG/INBkAGA+fkaDrNbhZtfa3rmkUUrCxKWaAFwiYsKgWJNl/0mRpxUuP+IT2c+Qhh26JEZtUWAmpuoaQCdQ3ykKWm2zaoAM5MBCGaGEuYe+6AS07/nLNRJwqp1jdwP1FgVCbXRvZtWfKjEZlNJYQ+EicVc6cv2DxCYJyTljvXwF8mKxenML6FKJiHARQCO8OMJidKKZQJP1SeYIhqB0YrtGw4cGV2ZquQKifvRjB2Tl6wBAWDmeCg+R1jvft1tR17SISyTDv77K+mV80w2aaUSgybbF7coM0BrQPcpehfjlW+YxV73+9mPMFXKQeznZ22T8MJor57O44p8U2NQCw35HiFBs0oVP9VkkY0D/WzGRevseyX1pIEWJSQSFwkJVhiyXavMDz5E5SEYgTZHfVeGBXCDuIEEbfRRkPU5yD2nw2ZAVimDRD7UQhEEY6PosGqU17He4y35WEfAggQ40+EKuupOQSZRsKotTTqlYGHJtX49ymuKqfyZzOAUSUzDMcj8gfDgzOCcuhw2sK3fJaMszKUbJMWISROKpBFzD1UxTc+EBd1DL9t2tz0xwRLKTTCoszZ3kLriRuxVc5YfyJNgxteACAxbN7Q7D22cf4NQH+fPOggAMLhs+dVfYmmW+zeIoHMA8V6Z6J2yVs7WLFUpLIrIojgPKZf9cPtwLfRraxagCmk18Gidl30o5j036klmIXjt9lZMVtUj8JMkvoYP23NRxGqhU0Is1EgXaZWxR3SDg35znI87QKmqBDfjJEo0kdIjJCWrk8WOECvWpgW+d005fCyhpB372NFk3VyCjdI1/FcMNaCQRXVZh/p3/FF/NKr4K+g01bt7ONRhkqXr77K/OR+qp8aX7fvkQM5e+YH+1h7sk2E3Q)"/>
#! <XFORM_PARM PARM_NAME="COMBINE_GEOM" PARM_VALUE="Initiator Geometry Only"/>
#! <XFORM_PARM PARM_NAME="POSTGIS_USER_NAME" PARM_VALUE="dbuser"/>
#! <XFORM_PARM PARM_NAME="COMBINE_ATTRS" PARM_VALUE="Result Attributes Only"/>
#! <XFORM_PARM PARM_NAME="POSTGIS_PORT" PARM_VALUE="5432"/>
#! <XFORM_PARM PARM_NAME="COORDSYS" PARM_VALUE=""/>
#! <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="SQLExecutor"/>
#! <XFORM_PARM PARM_NAME="PARAMETERS_GROUP" PARM_VALUE=""/>
#! </TRANSFORMER>
#! <TRANSFORMER
#! IDENTIFIER="35"
#! TYPE="VariableSetter"
#! VERSION="3"
#! POSITION="-1352 -930.509"
#! BOUNDING_RECT="-1352 -930.509 -1 -1"
#! ORDER="5e+014"
#! PARMS_EDITED="false"
#! ENABLED="true"
#! LAST_PARM_EDIT="15208"
#! >
#! <OUTPUT_FEAT NAME="OUTPUT"/>
#! <FEAT_COLLAPSED COLLAPSED="0"/>
#! <XFORM_ATTR ATTR_NAME="feature_id" IS_USER_CREATED="false" FEAT_INDEX="0" />
#! <XFORM_PARM PARM_NAME="TRANSFORMER_GROUP" PARM_VALUE=""/>
#! <XFORM_PARM PARM_NAME="PARAMETER_GROUP" PARM_VALUE=""/>
#! <XFORM_PARM PARM_NAME="VALUE" PARM_VALUE="true"/>
#! <XFORM_PARM PARM_NAME="SCOPE" PARM_VALUE="Global"/>
#! <XFORM_PARM PARM_NAME="VARNAME" PARM_VALUE="featuresRetrieved"/>
#! <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="VariableSetter"/>
#! </TRANSFORMER>
#! <TRANSFORMER
#! IDENTIFIER="41"
#! TYPE="VariableRetriever"
#! VERSION="3"
#! POSITION="-761.997 -1470.01"
#! BOUNDING_RECT="-761.997 -1470.01 -1 -1"
#! ORDER="5e+014"
#! PARMS_EDITED="true"
#! ENABLED="true"
#! LAST_PARM_EDIT="15208"
#! >
#! <OUTPUT_FEAT NAME="OUTPUT"/>
#! <FEAT_COLLAPSED COLLAPSED="0"/>
#! <XFORM_ATTR ATTR_NAME="_featuresRetrieved" IS_USER_CREATED="false" FEAT_INDEX="0" />
#! <XFORM_ATTR ATTR_NAME="_matched_records" IS_USER_CREATED="false" FEAT_INDEX="0" />
#! <XFORM_ATTR ATTR_NAME="_count" IS_USER_CREATED="false" FEAT_INDEX="0" />
#! <XFORM_PARM PARM_NAME="TRANSFORMER_GROUP" PARM_VALUE=""/>
#! <XFORM_PARM PARM_NAME="VALUE_ATTR" PARM_VALUE="_featuresRetrieved"/>
#! <XFORM_PARM PARM_NAME="PARAMETER_GROUP" PARM_VALUE=""/>
#! <XFORM_PARM PARM_NAME="SCOPE" PARM_VALUE="Global"/>
#! <XFORM_PARM PARM_NAME="VARNAME" PARM_VALUE="featuresRetrieved"/>
#! <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="VariableRetriever_2"/>
#! </TRANSFORMER>
#! <TRANSFORMER
#! IDENTIFIER="52"
#! TYPE="Tester"
#! VERSION="2"
#! POSITION="-207.997 -1470.01"
#! BOUNDING_RECT="-207.997 -1470.01 -1 -1"
#! ORDER="5e+014"
#! PARMS_EDITED="true"
#! ENABLED="true"
#! LAST_PARM_EDIT="15208"
#! >
#! <OUTPUT_FEAT NAME="PASSED"/>
#! <FEAT_COLLAPSED COLLAPSED="0"/>
#! <XFORM_ATTR ATTR_NAME="_featuresRetrieved" IS_USER_CREATED="false" FEAT_INDEX="0" />
#! <XFORM_ATTR ATTR_NAME="_matched_records" IS_USER_CREATED="false" FEAT_INDEX="0" />
#! <XFORM_ATTR ATTR_NAME="_count" IS_USER_CREATED="false" FEAT_INDEX="0" />
#! <OUTPUT_FEAT NAME="FAILED"/>
#! <FEAT_COLLAPSED COLLAPSED="1"/>
#! <XFORM_ATTR ATTR_NAME="_featuresRetrieved" IS_USER_CREATED="false" FEAT_INDEX="1" />
#! <XFORM_ATTR ATTR_NAME="_matched_records" IS_USER_CREATED="false" FEAT_INDEX="1" />
#! <XFORM_ATTR ATTR_NAME="_count" IS_USER_CREATED="false" FEAT_INDEX="1" />
#! <XFORM_PARM PARM_NAME="TEST_LIST" PARM_VALUE=""/>
#! <XFORM_PARM PARM_NAME="BOOL_OP" PARM_VALUE="OR"/>
#! <XFORM_PARM PARM_NAME="TEST_CLAUSE" PARM_VALUE="TEST &lt;at&gt;Value&lt;openparen&gt;_featuresRetrieved&lt;closeparen&gt; = true"/>
#! <XFORM_PARM PARM_NAME="TEST_MODE" PARM_VALUE="Automatic"/>
#! <XFORM_PARM PARM_NAME="COMPOSITE_TEST" PARM_VALUE="&lt;Unused&gt;"/>
#! <XFORM_PARM PARM_NAME="TEST_DESCRIPTION" PARM_VALUE="&quot;&quot;"/>
#! <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="Tester_2"/>
#! </TRANSFORMER>
#! </TRANSFORMERS>
#! <SUBDOCUMENT_IOS>
#! <SUBDOCUMENT_IO
#! IDENTIFIER="12"
#! NAME="Input"
#! POSITION="-1921 -69.25"
#! BOUNDING_RECT="-1921 -69.25 -1 -1"
#! COLLAPSED="true"
#! PUBLISHED="false"
#! IS_SOURCE="true"
#! ATTR_MODE="0"
#! >
#! </SUBDOCUMENT_IO>
#! <SUBDOCUMENT_IO
#! IDENTIFIER="14"
#! NAME="Input"
#! POSITION="632.011 -1470.01"
#! BOUNDING_RECT="632.011 -1470.01 -1 -1"
#! COLLAPSED="true"
#! IS_SOURCE="loop"
#! ATTR_MODE="0"
#! >
#! </SUBDOCUMENT_IO>
#! <SUBDOCUMENT_IO
#! IDENTIFIER="51"
#! NAME="Start"
#! POSITION="-2631.03 -930.509"
#! BOUNDING_RECT="-2631.03 -930.509 -1 -1"
#! COLLAPSED="true"
#! PUBLISHED="true"
#! IS_SOURCE="true"
#! ATTR_MODE="0"
#! >
#! </SUBDOCUMENT_IO>
#! <SUBDOCUMENT_IO
#! IDENTIFIER="30"
#! NAME="Output"
#! POSITION="-761.997 -1218.51"
#! BOUNDING_RECT="-761.997 -1218.51 -1 -1"
#! COLLAPSED="true"
#! IS_SOURCE="false"
#! ATTR_MODE="0"
#! >
#! </SUBDOCUMENT_IO>
#! </SUBDOCUMENT_IOS>
#! <FEAT_LINKS>
#! <FEAT_LINK
#! IDENTIFIER="43"
#! SOURCE_NODE="12"
#! TARGET_NODE="36"
#! SOURCE_PORT_DESC="0"
#! TARGET_PORT_DESC="fi 0"
#! ENABLED="true"
#! EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#! IDENTIFIER="45"
#! SOURCE_NODE="32"
#! TARGET_NODE="21"
#! SOURCE_PORT_DESC="fo 0"
#! TARGET_PORT_DESC="fi 0"
#! ENABLED="true"
#! EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#! IDENTIFIER="46"
#! SOURCE_NODE="36"
#! TARGET_NODE="34"
#! SOURCE_PORT_DESC="fo 0"
#! TARGET_PORT_DESC="fi 0"
#! ENABLED="true"
#! EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#! IDENTIFIER="47"
#! SOURCE_NODE="34"
#! TARGET_NODE="32"
#! SOURCE_PORT_DESC="fo 0"
#! TARGET_PORT_DESC="fi 0"
#! ENABLED="true"
#! EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#! IDENTIFIER="48"
#! SOURCE_NODE="19"
#! TARGET_NODE="42"
#! SOURCE_PORT_DESC="fo 0"
#! TARGET_PORT_DESC="fi 0"
#! ENABLED="true"
#! EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#! IDENTIFIER="39"
#! SOURCE_NODE="21"
#! TARGET_NODE="29"
#! SOURCE_PORT_DESC="fo 1"
#! TARGET_PORT_DESC="fi 0"
#! ENABLED="true"
#! EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#! IDENTIFIER="44"
#! SOURCE_NODE="21"
#! TARGET_NODE="35"
#! SOURCE_PORT_DESC="fo 0"
#! TARGET_PORT_DESC="fi 0"
#! ENABLED="true"
#! EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#! IDENTIFIER="49"
#! SOURCE_NODE="35"
#! TARGET_NODE="19"
#! SOURCE_PORT_DESC="fo 0"
#! TARGET_PORT_DESC="fi 0"
#! ENABLED="true"
#! EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#! IDENTIFIER="50"
#! SOURCE_NODE="29"
#! TARGET_NODE="41"
#! SOURCE_PORT_DESC="fo 0"
#! TARGET_PORT_DESC="fi 0"
#! ENABLED="true"
#! EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#! IDENTIFIER="53"
#! SOURCE_NODE="41"
#! TARGET_NODE="52"
#! SOURCE_PORT_DESC="fo 0"
#! TARGET_PORT_DESC="fi 0"
#! ENABLED="true"
#! EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#! IDENTIFIER="54"
#! SOURCE_NODE="52"
#! TARGET_NODE="14"
#! SOURCE_PORT_DESC="fo 1"
#! TARGET_PORT_DESC="0"
#! ENABLED="true"
#! EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#! IDENTIFIER="55"
#! SOURCE_NODE="51"
#! TARGET_NODE="21"
#! SOURCE_PORT_DESC="0"
#! TARGET_PORT_DESC="fi 0"
#! ENABLED="true"
#! EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#! IDENTIFIER="31"
#! SOURCE_NODE="19"
#! TARGET_NODE="30"
#! SOURCE_PORT_DESC="fo 1"
#! TARGET_PORT_DESC="0"
#! ENABLED="true"
#! EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#! IDENTIFIER="33"
#! SOURCE_NODE="19"
#! TARGET_NODE="30"
#! SOURCE_PORT_DESC="fo 0"
#! TARGET_PORT_DESC="0"
#! ENABLED="true"
#! EXTRA_POINTS=""
#! />
#! </FEAT_LINKS>
#! <BREAKPOINTS>
#! </BREAKPOINTS>
#! <ATTR_LINKS>
#! </ATTR_LINKS>
#! </SUBDOCUMENT>
#! </SUBDOCUMENTS>
#! <LOOKUP_TABLES>
#! </LOOKUP_TABLES>
#! </WORKSPACE>
#! 
DEFAULT_MACRO minID 1
GUI OPTIONAL INTEGER minID Minimum ID:
DEFAULT_MACRO maxID 300
GUI OPTIONAL INTEGER maxID Maximum ID:
DEFAULT_MACRO type i
GUI OPTIONAL TEXT type Type:
DEFAULT_MACRO WEBSOCKET_URL wss://myfmeserver:7078/websocket
GUI IGNORE TEXT WEBSOCKET_URL WebSocket Server URL:
INCLUDE [ if {{$(WEBSOCKET_URL)} == {}} { puts_real {Parameter 'WEBSOCKET_URL' must be given a value.}; exit 1; }; ]
#! START_HEADER
#! START_WB_HEADER
READER_TYPE NULL
READER_KEYWORD NULL_SOURCE
NULL_SOURCE_DATASET null
WRITER_TYPE NULL
WRITER_KEYWORD NULL_DEST
NULL_DEST_DATASET null
#! END_WB_HEADER
#! END_HEADER

LOG_FILENAME "$(FME_MF_DIR)websocket-stream.log"
LOG_APPEND NO
LOG_MAX_FEATURES 200
LOG_MAX_RECORDED_FEATURES 200
LOG_MAX_PRECISION Yes
FME_REPROJECTION_ENGINE FME
FME_IMPLICIT_CSMAP_REPROJECTION_MODE Auto
FME_GEOMETRY_HANDLING Enhanced
FME_STROKE_MAX_DEVIATION 0
LOG_FILTER_MASK -1
# -------------------------------------------------------------------------

MULTI_READER_CONTINUE_ON_READER_FAILURE No

# -------------------------------------------------------------------------

MACRO WORKSPACE_NAME websocket-stream
MACRO FME_VIEWER_APP fmedatainspector
# -------------------------------------------------------------------------

INCLUDE [ if {[info exists env(FME_TEMP)] && [file isdirectory $env(FME_TEMP)]} {set gVisualizerTemp $env(FME_TEMP)}  elseif {[info exists env(TEMP)] && [file isdirectory $env(TEMP)]}  {set gVisualizerTemp $env(TEMP)}  elseif { $tcl_platform(platform) == "unix" } {set gVisualizerTemp "/tmp"} else {set gVisualizerTemp c:};  regsub -all {[ ,&]} {$(WORKSPACE_NAME)} {_} wsname; set gVisualizerTemp $gVisualizerTemp/${wsname}_[clock format [clock seconds] -format %H%M%S];  puts "MACRO WORKSPACE_TEMP_DIR $gVisualizerTemp"; 
MACRO VISUALIZER_FEATURE_FILE $(WORKSPACE_TEMP_DIR)/inspector.ffs
MACRO VISUALIZER_SCHEMA_FILE $(WORKSPACE_TEMP_DIR)/inspector.fsc
MACRO VISUALIZER_CREATE_SPATIAL_INDEX YES
DEFAULT_MACRO WB_CURRENT_CONTEXT
# -------------------------------------------------------------------------

Tcl2 proc Creator_CoordSysRemover {} {   global FME_CoordSys;   set FME_CoordSys {}; }
MACRO Creator_XML     NOT_ACTIVATED
MACRO Creator_CLASSIC NOT_ACTIVATED
MACRO Creator_2D3D    2D_GEOMETRY
MACRO Creator_COORDS  <Unused>
INCLUDE [ if { {Geometry Object} == {Geometry Object} } {            puts {MACRO Creator_XML *} } ]
INCLUDE [ if { {Geometry Object} == {2D Coordinate List} } {            puts {MACRO Creator_2D3D 2D_GEOMETRY};            puts {MACRO Creator_CLASSIC *} } ]
INCLUDE [ if { {Geometry Object} == {3D Coordinate List} } {            puts {MACRO Creator_2D3D 3D_GEOMETRY};            puts {MACRO Creator_CLASSIC *} } ]
INCLUDE [ if { {Geometry Object} == {2D Min/Max Box} } {            set comment {                We need to turn the COORDS which are                    minX minY maxX maxY                into a full polygon list of coordinates            };            set splitCoords [split [string trim {<Unused>}]];            if { [llength $splitCoords] > 4} {               set trimmedCoords {};               foreach item $splitCoords { if { $item != {} } {lappend trimmedCoords $item} };               set splitCoords $trimmedCoords;            };            if { [llength $splitCoords] != 4 } {                error {Creator: Coordinate list is expected to be a space delimited list of four numbers as 'minx miny maxx maxy' - `<Unused>' is invalid};            };            set minX [lindex $splitCoords 0];            set minY [lindex $splitCoords 1];            set maxX [lindex $splitCoords 2];            set maxY [lindex $splitCoords 3];            puts "MACRO Creator_COORDS $minX $minY $minX $maxY $maxX $maxY $maxX $minY $minX $minY";            puts {MACRO Creator_2D3D 2D_GEOMETRY};            puts {MACRO Creator_CLASSIC *} } ]
FACTORY_DEF $(Creator_XML) CreationFactory    FACTORY_NAME Creator_XML_Creator    CREATE_AT_END no    OUTPUT FEATURE_TYPE _____CREATED______        @Geometry(FROM_ENCODED_STRING,<lt>?xml<space>version=<quote>1.0<quote><space>encoding=<quote>US_ASCII<quote><space>standalone=<quote>no<quote><space>?<gt><lt>geometry<space>dimension=<quote>2<quote><gt><lt>null<solidus><gt><lt><solidus>geometry<gt>)
FACTORY_DEF $(Creator_CLASSIC) CreationFactory    FACTORY_NAME Creator_CLASSIC_Creator    $(Creator_2D3D) $(Creator_COORDS)    CREATE_AT_END no    OUTPUT FEATURE_TYPE _____CREATED______
FACTORY_DEF * TeeFactory    FACTORY_NAME Creator_Cloner    INPUT FEATURE_TYPE _____CREATED______    NUMBER_OF_COPIES 1    COPY_NUMBER_ATTRIBUTE "_creation_instance"    OUTPUT FEATURE_TYPE Creator_CREATED        @Tcl2(Creator_CoordSysRemover)        @CoordSys()        fme_feature_type Creator

# -------------------------------------------------------------------------
FACTORY_DEF * TeeFactory   FACTORY_NAME "DatabaseQueryLooper Start Input Collector"   INPUT FEATURE_TYPE Creator_CREATED   OUTPUT FEATURE_TYPE DatabaseQueryLooper_Start
MACRO DatabaseQueryLooper_WORKSPACE_NAME DatabaseQueryLooper
MACRO $(DatabaseQueryLooper_WORKSPACE_NAME)_XFORMER_NAME DatabaseQueryLooper
MACRO $(DatabaseQueryLooper_WORKSPACE_NAME)_TRANSFORMER_GROUP 
MACRO $(DatabaseQueryLooper_WORKSPACE_NAME)___COMPOUND_PARAMETERS 
MACRO $(DatabaseQueryLooper_WORKSPACE_NAME)_SUB_DOC_NAME DatabaseQueryLooper
MACRO $(DatabaseQueryLooper_WORKSPACE_NAME)_type $(type)
MACRO $(DatabaseQueryLooper_WORKSPACE_NAME)_minID $(minID)
MACRO $(DatabaseQueryLooper_WORKSPACE_NAME)_maxID $(maxID)
DEFAULT_MACRO DatabaseQueryLooper_WORKSPACE_NAME ""
INCLUDE [puts {MACRO WB_OLD_CONTEXT_$(DatabaseQueryLooper_WORKSPACE_NAME) $(WB_CURRENT_CONTEXT)};          puts {MACRO WB_CURRENT_CONTEXT $(DatabaseQueryLooper_WORKSPACE_NAME)}]
FACTORY_DEF * TeeFactory   FACTORY_NAME "$(DatabaseQueryLooper_WORKSPACE_NAME)_Input1416598258 Input Splitter"   INPUT FEATURE_TYPE "$(DatabaseQueryLooper_WORKSPACE_NAME)_Input"   OUTPUT FEATURE_TYPE "$(DatabaseQueryLooper_WORKSPACE_NAME)_Input"
FACTORY_DEF * TeeFactory   FACTORY_NAME "$(DatabaseQueryLooper_WORKSPACE_NAME)_Start1416598258 Input Splitter"   INPUT FEATURE_TYPE "$(DatabaseQueryLooper_WORKSPACE_NAME)_Start"   OUTPUT FEATURE_TYPE "$(DatabaseQueryLooper_WORKSPACE_NAME)_Start"
# -------------------------------------------------------------------------

DEFAULT_MACRO WB_CURRENT_CONTEXT
MACRO $(DatabaseQueryLooper_WORKSPACE_NAME)_VariableRetriever_VAR featuresRetrieved
INCLUDE [if {{Global} == {Local}} {   puts {MACRO $(DatabaseQueryLooper_WORKSPACE_NAME)_VariableRetriever_VAR $(WB_CURRENT_CONTEXT)_featuresRetrieved}; };
FACTORY_DEF * TeeFactory    FACTORY_NAME $(DatabaseQueryLooper_WORKSPACE_NAME)_VariableRetriever    INPUT  FEATURE_TYPE "$(DatabaseQueryLooper_WORKSPACE_NAME)_Input"    OUTPUT FEATURE_TYPE "$(DatabaseQueryLooper_WORKSPACE_NAME)_VariableRetriever_OUTPUT"        @GlobalVariable(fme_encoded,$($(DatabaseQueryLooper_WORKSPACE_NAME)_VariableRetriever_VAR),fme_result_attribute,_featuresRetrieved)

# -------------------------------------------------------------------------

FACTORY_DEF * TestFactory    FACTORY_NAME $(DatabaseQueryLooper_WORKSPACE_NAME)_Tester    INPUT  FEATURE_TYPE "$(DatabaseQueryLooper_WORKSPACE_NAME)_VariableRetriever_OUTPUT"    TEST @EvaluateExpression(FDIV,STRING_ENCODED,<at>Value<openparen>_count<closeparen>,$(DatabaseQueryLooper_WORKSPACE_NAME)_Tester) <= 15 ENCODED TEST @EvaluateExpression(FDIV,STRING_ENCODED,<at>Value<openparen>_featuresRetrieved<closeparen>,$(DatabaseQueryLooper_WORKSPACE_NAME)_Tester) != true ENCODED    BOOLEAN_OPERATOR AND    OUTPUT PASSED FEATURE_TYPE "$(DatabaseQueryLooper_WORKSPACE_NAME)_Tester_PASSED"
# -------------------------------------------------------------------------

# This is just a simple delay, which is given a # of seconds to stall

Tcl2 proc $(DatabaseQueryLooper_WORKSPACE_NAME)_Decelerator_2_delay {seconds unused} {     after [expr round($seconds * 1000)]; }
Tcl2 set $(DatabaseQueryLooper_WORKSPACE_NAME)_Decelerator_2_clockMillisecondsWhenLastFeatureWentBy [clock clicks -milliseconds];

# This proc ensures that no more than some maximum number of features get through each second

Tcl2 proc $(DatabaseQueryLooper_WORKSPACE_NAME)_Decelerator_2_maxpersecond {unused maxFeaturesPerSecond} {     global $(DatabaseQueryLooper_WORKSPACE_NAME)_Decelerator_2_clockMillisecondsWhenLastFeatureWentBy;     set minimumDelayInMilliseconds [expr 1000.0 / $maxFeaturesPerSecond];     set clockMillisecondsNow [clock clicks -milliseconds];     set milliSecondsSinceLastFeature [expr $clockMillisecondsNow -                    [set $(DatabaseQueryLooper_WORKSPACE_NAME)_Decelerator_2_clockMillisecondsWhenLastFeatureWentBy]];     if {$milliSecondsSinceLastFeature < $minimumDelayInMilliseconds} {         after [expr round($minimumDelayInMilliseconds - $milliSecondsSinceLastFeature)];     };     set $(DatabaseQueryLooper_WORKSPACE_NAME)_Decelerator_2_clockMillisecondsWhenLastFeatureWentBy [clock clicks -milliseconds]; }
# Now set up which of the above two delay procedures we'll actually
# use by renaming the one we want to "$(DatabaseQueryLooper_WORKSPACE_NAME)_Decelerator_2_Waiter"
# Then that is what we'll actually call when a feature goes by.

Tcl2 if { {Per Feature Delay} == {Per Feature Delay} } {         rename $(DatabaseQueryLooper_WORKSPACE_NAME)_Decelerator_2_delay $(DatabaseQueryLooper_WORKSPACE_NAME)_Decelerator_2_Waiter;      } else {         rename $(DatabaseQueryLooper_WORKSPACE_NAME)_Decelerator_2_maxpersecond $(DatabaseQueryLooper_WORKSPACE_NAME)_Decelerator_2_Waiter;      };
FACTORY_DEF * TeeFactory    FACTORY_NAME $(DatabaseQueryLooper_WORKSPACE_NAME)_Decelerator_2    INPUT  FEATURE_TYPE "$(DatabaseQueryLooper_WORKSPACE_NAME)_Tester_PASSED"    OUTPUT FEATURE_TYPE "$(DatabaseQueryLooper_WORKSPACE_NAME)_Decelerator_2_OUTPUT"         @Tcl2("$(DatabaseQueryLooper_WORKSPACE_NAME)_Decelerator_2_Waiter {1} {<Unused>}")

# -------------------------------------------------------------------------
MACRO $(DatabaseQueryLooper_WORKSPACE_NAME)_SQLExecutor_2_DIRECTIVES PORT 5432 USER_NAME dbuser HOST my-postgis-server PASSWORD fme_decrypt(MDowfCN8I3xcG3GQ/TeRRUJUZ5LDPtdvpscbh7Nj9gG/INBkAGA+fkaDrNbhZtfa3rmkUUrCxKWaAFwiYsKgWJNl/0mRpxUuP+IT2c+Qhh26JEZtUWAmpuoaQCdQ3ykKWm2zaoAM5MBCGaGEuYe+6AS07/nLNRJwqp1jdwP1FgVCbXRvZtWfKjEZlNJYQ+EicVc6cv2DxCYJyTljvXwF8mKxenML6FKJiHARQCO8OMJidKKZQJP1SeYIhqB0YrtGw4cGV2ZquQKifvRjB2Tl6wBAWDmeCg+R1jvft1tR17SISyTDv77K+mV80w2aaUSgybbF7coM0BrQPcpehfjlW+YxV73+9mPMFXKQeznZ22T8MJor57O44p8U2NQCw35HiFBs0oVP9VkkY0D/WzGRevseyX1pIEWJSQSFwkJVhiyXavMDz5E5SEYgTZHfVeGBXCDuIEEbfRRkPU5yD2nw2ZAVimDRD7UQhEEY6PosGqU17He4y35WEfAggQ40+EKuupOQSZRsKotTTqlYGHJtX49ymuKqfyZzOAUSUzDMcj8gfDgzOCcuhw2sK3fJaMszmgnHpD4eJYzNVdHTpDgZ5Cw+ILkMEVbZMrkzbe8VmSS2V+p08BDoAwg4C36fPyEESja7hBskTu2XrfYwjTHRbvi2TsfCwaRI/UGka5Qi+i8tagXLieFL8UAZsAtqP+iQeoaM3YOsc/AMAot9WMyqV+CyAYGPCTdeCq7Y3rQ9dQGQFR0samdxZuW/+Q6blJgOzo27GMpdk/Rddz5mTJVbf16HhFmt2ASRy2B20Hg6Sew8puaXCf/OsCSbIQ4j+ZRpyGsHGCCVugN4VUaeSagaRvNa9m/1cG/i4Jalgu6y1LoW2kxTRyuDrJF1wqdF1smOJ+YCu6oWHcorJXN43iHJCE8seTd9T5kC)

FACTORY_DEF * QueryFactory    FACTORY_NAME $(DatabaseQueryLooper_WORKSPACE_NAME)_SQLExecutor_2    INPUT  FEATURE_TYPE "$(DatabaseQueryLooper_WORKSPACE_NAME)_Decelerator_2_OUTPUT"    INPUT  FEATURE_TYPE "$(DatabaseQueryLooper_WORKSPACE_NAME)_Start"    QUERY_SQL            "@EvaluateExpression(FDIV,STRING_ENCODED,SELECT<space>*<space>FROM<space>cad_qa.<quote>WATERLINES<quote><space>AS<space>w<comma><space>cad_qa.temp_ids<space>AS<space>t<lf>WHERE<space><space>w.primaryindex<space>=<space>t.primaryindex<lf>AND<space>t.primaryindex<space>BETWEEN<space>$($(DatabaseQueryLooper_WORKSPACE_NAME)_minID$encode)<space>AND<space>$($(DatabaseQueryLooper_WORKSPACE_NAME)_maxID$encode)<semicolon>,$(DatabaseQueryLooper_WORKSPACE_NAME)_SQLExecutor_2)"    READER_TYPE          POSTGIS    READER_DATASET       "FME_EXPOSE:HOST|my-postgis-server|PORT|5432|DATASET|gisdb|USER_NAME|dbuser|PASSWORD|fme_decrypt<openparen>MDowfCN8I3xcG3GQ<solidus>TeRRUJUZ5LDPtdvpscbh7Nj9gG<solidus>INBkAGA+fkaDrNbhZtfa3rmkUUrCxKWaAFwiYsKgWJNl<solidus>0mRpxUuP+IT2c+Qhh26JEZtUWAmpuoaQCdQ3ykKWm2zaoAM5MBCGaGEuYe+6AS07<solidus>nLNRJwqp1jdwP1FgVCbXRvZtWfKjEZlNJYQ+EicVc6cv2DxCYJyTljvXwF8mKxenML6FKJiHARQCO8OMJidKKZQJP1SeYIhqB0YrtGw4cGV2ZquQKifvRjB2Tl6wBAWDmeCg+R1jvft1tR17SISyTDv77K+mV80w2aaUSgybbF7coM0BrQPcpehfjlW+YxV73+9mPMFXKQeznZ22T8MJor57O44p8U2NQCw35HiFBs0oVP9VkkY0D<solidus>WzGRevseyX1pIEWJSQSFwkJVhiyXavMDz5E5SEYgTZHfVeGBXCDuIEEbfRRkPU5yD2nw2ZAVimDRD7UQhEEY6PosGqU17He4y35WEfAggQ40+EKuupOQSZRsKotTTqlYGHJtX49ymuKqfyZzOAUSUzDMcj8gfDgzOCcuhw2sK3fJaMszmgnHpD4eJYzNVdHTpDgZ5Cw+ILkMEVbZMrkzbe8VmSS2V+p08BDoAwg4C36fPyEESja7hBskTu2XrfYwjTHRbvi2TsfCwaRI<solidus>UGka5Qi+i8tagXLieFL8UAZsAtqP+iQeoaM3YOsc<solidus>AMAot9WMyqV+CyAYGPCTdeCq7Y3rQ9dQGQFR0samdxZuW<solidus>+Q6blJgOzo27GMpdk<solidus>Rddz5mTJVbf16HhFmt2ASRy2B20Hg6Sew8puaXCf<solidus>OsCSbIQ4j+ZRpyGsHGCCVugN4VUaeSagaRvNa9m<solidus>1cG<solidus>i4Jalgu6y1LoW2kxTRyuDrJF1wqdF1smOJ+YCu6oWHcorJXN43iHJCE8seTd9T5kC<closeparen>"    COMBINE_ATTRIBUTES   RESULT_ONLY    COMBINE_GEOMETRY     RESULT_ONLY    READER_PARAMS        $($(DatabaseQueryLooper_WORKSPACE_NAME)_SQLExecutor_2_DIRECTIVES)    OUTPUT RESULT FEATURE_TYPE "$(DatabaseQueryLooper_WORKSPACE_NAME)_SQLExecutor_2_RESULT"    OUTPUT QUERY FEATURE_TYPE "$(DatabaseQueryLooper_WORKSPACE_NAME)_SQLExecutor_2_INITIATOR"

# -------------------------------------------------------------------------

Tcl2 proc $(DatabaseQueryLooper_WORKSPACE_NAME)_Counter_fdb75fa5_d3e9_46ff_b48c_1b4a2a924b0d10_createDomain { in_domainName } {    set domainName $in_domainName;    if { {Global} == {Local} }    {       set xFormName [FME_EncodeText {$(DatabaseQueryLooper_WORKSPACE_NAME)_Counter_}];       set domainName $xFormName$domainName;    };    return $domainName; }

FACTORY_DEF * TeeFactory    FACTORY_NAME $(DatabaseQueryLooper_WORKSPACE_NAME)_Counter    INPUT  FEATURE_TYPE "$(DatabaseQueryLooper_WORKSPACE_NAME)_SQLExecutor_2_INITIATOR"    OUTPUT FEATURE_TYPE "$(DatabaseQueryLooper_WORKSPACE_NAME)_Counter_OUTPUT"         "_count" @Count(fme_encoded,@Tcl2("$(DatabaseQueryLooper_WORKSPACE_NAME)_Counter_fdb75fa5_d3e9_46ff_b48c_1b4a2a924b0d10_createDomain {counter}"), "0")

# -------------------------------------------------------------------------

DEFAULT_MACRO WB_CURRENT_CONTEXT
MACRO $(DatabaseQueryLooper_WORKSPACE_NAME)_VariableRetriever_2_VAR featuresRetrieved
INCLUDE [if {{Global} == {Local}} {   puts {MACRO $(DatabaseQueryLooper_WORKSPACE_NAME)_VariableRetriever_2_VAR $(WB_CURRENT_CONTEXT)_featuresRetrieved}; };
FACTORY_DEF * TeeFactory    FACTORY_NAME $(DatabaseQueryLooper_WORKSPACE_NAME)_VariableRetriever_2    INPUT  FEATURE_TYPE "$(DatabaseQueryLooper_WORKSPACE_NAME)_Counter_OUTPUT"    OUTPUT FEATURE_TYPE "$(DatabaseQueryLooper_WORKSPACE_NAME)_VariableRetriever_2_OUTPUT"        @GlobalVariable(fme_encoded,$($(DatabaseQueryLooper_WORKSPACE_NAME)_VariableRetriever_2_VAR),fme_result_attribute,_featuresRetrieved)

# -------------------------------------------------------------------------

FACTORY_DEF * TestFactory    FACTORY_NAME $(DatabaseQueryLooper_WORKSPACE_NAME)_Tester_2    INPUT  FEATURE_TYPE "$(DatabaseQueryLooper_WORKSPACE_NAME)_VariableRetriever_2_OUTPUT"    TEST @EvaluateExpression(FDIV,STRING_ENCODED,<at>Value<openparen>_featuresRetrieved<closeparen>,$(DatabaseQueryLooper_WORKSPACE_NAME)_Tester_2) = true ENCODED    BOOLEAN_OPERATOR OR    OUTPUT FAILED FEATURE_TYPE "$(DatabaseQueryLooper_WORKSPACE_NAME)_Tester_2_FAILED"
# -------------------------------------------------------------------------

DEFAULT_MACRO WB_CURRENT_CONTEXT
MACRO $(DatabaseQueryLooper_WORKSPACE_NAME)_VariableSetter_VAR featuresRetrieved
INCLUDE [ if {{Global} == {Local}} {   puts {MACRO $(DatabaseQueryLooper_WORKSPACE_NAME)_VariableSetter_VAR $(WB_CURRENT_CONTEXT)_featuresRetrieved}; } ]
FACTORY_DEF * TeeFactory    FACTORY_NAME $(DatabaseQueryLooper_WORKSPACE_NAME)_VariableSetter    INPUT  FEATURE_TYPE "$(DatabaseQueryLooper_WORKSPACE_NAME)_SQLExecutor_2_RESULT"    OUTPUT FEATURE_TYPE "$(DatabaseQueryLooper_WORKSPACE_NAME)_VariableSetter_OUTPUT"        @GlobalVariable(fme_encoded,$($(DatabaseQueryLooper_WORKSPACE_NAME)_VariableSetter_VAR),"true")

# -------------------------------------------------------------------------

INCLUDE [ puts "MACRO REAL_RATE [expr 1 * -1 ]" ]
FACTORY_DEF * SamplingFactory    FACTORY_NAME $(DatabaseQueryLooper_WORKSPACE_NAME)_Sampler    SAMPLE_RATE $(REAL_RATE)    INPUT  FEATURE_TYPE "$(DatabaseQueryLooper_WORKSPACE_NAME)_VariableSetter_OUTPUT"    OUTPUT SAMPLED FEATURE_TYPE ___SAMPLED___    OUTPUT NOT_SAMPLED FEATURE_TYPE "$(DatabaseQueryLooper_WORKSPACE_NAME)_Sampler_NOT_SAMPLED"
# This TeeFactory is needed because Sampler will still output features if it has no OUTPUT clauses specified.
# This way we behave nicely even if there are no output connections on the transformer. See PR#28886.

FACTORY_DEF * TeeFactory    FACTORY_NAME $(DatabaseQueryLooper_WORKSPACE_NAME)_Sampler_Sampled    INPUT FEATURE_TYPE ___SAMPLED___    OUTPUT FEATURE_TYPE "$(DatabaseQueryLooper_WORKSPACE_NAME)_Sampler_SAMPLED"


FACTORY_DEF * TeeFactory   FACTORY_NAME "$(DatabaseQueryLooper_WORKSPACE_NAME)_Sampler SAMPLED Splitter"   INPUT FEATURE_TYPE "$(DatabaseQueryLooper_WORKSPACE_NAME)_Sampler_SAMPLED"   OUTPUT FEATURE_TYPE "$(DatabaseQueryLooper_WORKSPACE_NAME)_Sampler_SAMPLED_0_0DhWD0eLDAI="   OUTPUT FEATURE_TYPE "$(DatabaseQueryLooper_WORKSPACE_NAME)_Sampler_SAMPLED_1_0DhWD0eLDAI="
# -------------------------------------------------------------------------
MACRO $(DatabaseQueryLooper_WORKSPACE_NAME)_SQLExecutor_DIRECTIVES PORT 5432 USER_NAME dbuser HOST my-postgis-server PASSWORD fme_decrypt(MDowfCN8I3xcG3GQ/TeRRUJUZ5LDPtdvpscbh7Nj9gG/INBkAGA+fkaDrNbhZtfa3rmkUUrCxKWaAFwiYsKgWJNl/0mRpxUuP+IT2c+Qhh26JEZtUWAmpuoaQCdQ3ykKWm2zaoAM5MBCGaGEuYe+6AS07/nLNRJwqp1jdwP1FgVCbXRvZtWfKjEZlNJYQ+EicVc6cv2DxCYJyTljvXwF8mKxenML6FKJiHARQCO8OMJidKKZQJP1SeYIhqB0YrtGw4cGV2ZquQKifvRjB2Tl6wBAWDmeCg+R1jvft1tR17SISyTDv77K+mV80w2aaUSgybbF7coM0BrQPcpehfjlW+YxV73+9mPMFXKQeznZ22T8MJor57O44p8U2NQCw35HiFBs0oVP9VkkY0D/WzGRevseyX1pIEWJSQSFwkJVhiyXavMDz5E5SEYgTZHfVeGBXCDuIEEbfRRkPU5yD2nw2ZAVimDRD7UQhEEY6PosGqU17He4y35WEfAggQ40+EKuupOQSZRsKotTTqlYGHJtX49ymuKqfyZzOAUSUzDMcj8gfDgzOCcuhw2sK3fJaMszKUbJMWISROKpBFzD1UxTc+EBd1DL9t2tz0xwRLKTTCoszZ3kLriRuxVc5YfyJNgxteACAxbN7Q7D22cf4NQH+fPOggAMLhs+dVfYmmW+zeIoHMA8V6Z6J2yVs7WLFUpLIrIojgPKZf9cPtwLfRraxagCmk18Gidl30o5j036klmIXjt9lZMVtUj8JMkvoYP23NRxGqhU0Is1EgXaZWxR3SDg35znI87QKmqBDfjJEo0kdIjJCWrk8WOECvWpgW+d005fCyhpB372NFk3VyCjdI1/FcMNaCQRXVZh/p3/FF/NKr4K+g01bt7ONRhkqXr77K/OR+qp8aX7fvkQM5e+YH+1h7sk2E3Q)

FACTORY_DEF * QueryFactory    FACTORY_NAME $(DatabaseQueryLooper_WORKSPACE_NAME)_SQLExecutor    INPUT  FEATURE_TYPE "$(DatabaseQueryLooper_WORKSPACE_NAME)_Sampler_SAMPLED_1_0DhWD0eLDAI="    QUERY_SQL            "@EvaluateExpression(FDIV,STRING_ENCODED,DELETE<space>FROM<space>cad_qa.temp_ids<space>WHERE<space>primaryindex<space>BETWEEN<space>$($(DatabaseQueryLooper_WORKSPACE_NAME)_minID$encode)<space>AND<space>$($(DatabaseQueryLooper_WORKSPACE_NAME)_maxID$encode),$(DatabaseQueryLooper_WORKSPACE_NAME)_SQLExecutor)"    READER_TYPE          POSTGIS    READER_DATASET       "FME_EXPOSE:HOST|my-postgis-server|PORT|5432|DATASET|gisdb|USER_NAME|dbuser|PASSWORD|fme_decrypt<openparen>MDowfCN8I3xcG3GQ<solidus>TeRRUJUZ5LDPtdvpscbh7Nj9gG<solidus>INBkAGA+fkaDrNbhZtfa3rmkUUrCxKWaAFwiYsKgWJNl<solidus>0mRpxUuP+IT2c+Qhh26JEZtUWAmpuoaQCdQ3ykKWm2zaoAM5MBCGaGEuYe+6AS07<solidus>nLNRJwqp1jdwP1FgVCbXRvZtWfKjEZlNJYQ+EicVc6cv2DxCYJyTljvXwF8mKxenML6FKJiHARQCO8OMJidKKZQJP1SeYIhqB0YrtGw4cGV2ZquQKifvRjB2Tl6wBAWDmeCg+R1jvft1tR17SISyTDv77K+mV80w2aaUSgybbF7coM0BrQPcpehfjlW+YxV73+9mPMFXKQeznZ22T8MJor57O44p8U2NQCw35HiFBs0oVP9VkkY0D<solidus>WzGRevseyX1pIEWJSQSFwkJVhiyXavMDz5E5SEYgTZHfVeGBXCDuIEEbfRRkPU5yD2nw2ZAVimDRD7UQhEEY6PosGqU17He4y35WEfAggQ40+EKuupOQSZRsKotTTqlYGHJtX49ymuKqfyZzOAUSUzDMcj8gfDgzOCcuhw2sK3fJaMszKUbJMWISROKpBFzD1UxTc+EBd1DL9t2tz0xwRLKTTCoszZ3kLriRuxVc5YfyJNgxteACAxbN7Q7D22cf4NQH+fPOggAMLhs+dVfYmmW+zeIoHMA8V6Z6J2yVs7WLFUpLIrIojgPKZf9cPtwLfRraxagCmk18Gidl30o5j036klmIXjt9lZMVtUj8JMkvoYP23NRxGqhU0Is1EgXaZWxR3SDg35znI87QKmqBDfjJEo0kdIjJCWrk8WOECvWpgW+d005fCyhpB372NFk3VyCjdI1<solidus>FcMNaCQRXVZh<solidus>p3<solidus>FF<solidus>NKr4K+g01bt7ONRhkqXr77K<solidus>OR+qp8aX7fvkQM5e+YH+1h7sk2E3Q<closeparen>"    COMBINE_ATTRIBUTES   RESULT_ONLY    COMBINE_GEOMETRY     QUERY_ONLY    READER_PARAMS        $($(DatabaseQueryLooper_WORKSPACE_NAME)_SQLExecutor_DIRECTIVES)    OUTPUT RESULT FEATURE_TYPE "$(DatabaseQueryLooper_WORKSPACE_NAME)_SQLExecutor_RESULT"    OUTPUT QUERY FEATURE_TYPE "$(DatabaseQueryLooper_WORKSPACE_NAME)_SQLExecutor_INITIATOR"

FACTORY_DEF * TeeFactory   FACTORY_NAME "$(DatabaseQueryLooper_WORKSPACE_NAME)_SQLExecutor RESULT Output Nuker"   INPUT FEATURE_TYPE "$(DatabaseQueryLooper_WORKSPACE_NAME)_SQLExecutor_RESULT"
FACTORY_DEF * TeeFactory   FACTORY_NAME "$(DatabaseQueryLooper_WORKSPACE_NAME)_SQLExecutor INITIATOR Output Nuker"   INPUT FEATURE_TYPE "$(DatabaseQueryLooper_WORKSPACE_NAME)_SQLExecutor_INITIATOR"
FACTORY_DEF * BranchingFactory   TARGET_FACTORY "$(DatabaseQueryLooper_WORKSPACE_NAME)_Input1416598258 Input Splitter"   FACTORY_NAME "Loop to $(DatabaseQueryLooper_WORKSPACE_NAME)_Input1416598258 Input Splitter"   MAXIMUM_COUNT -1   INPUT FEATURE_TYPE "$(DatabaseQueryLooper_WORKSPACE_NAME)_Tester_2_FAILED"   OUTPUT PASSED FEATURE_TYPE "$(DatabaseQueryLooper_WORKSPACE_NAME)_Input"
FACTORY_DEF * TeeFactory   FACTORY_NAME "$(DatabaseQueryLooper_WORKSPACE_NAME)_Output1416598258 Output Collector"   INPUT FEATURE_TYPE "$(DatabaseQueryLooper_WORKSPACE_NAME)_Sampler_NOT_SAMPLED"   INPUT FEATURE_TYPE "$(DatabaseQueryLooper_WORKSPACE_NAME)_Sampler_SAMPLED_0_0DhWD0eLDAI="   OUTPUT FEATURE_TYPE "$(DatabaseQueryLooper_WORKSPACE_NAME)_Output"
INCLUDE [puts {MACRO WB_CURRENT_CONTEXT $(WB_OLD_CONTEXT_$(DatabaseQueryLooper_WORKSPACE_NAME))}]
FACTORY_DEF * TeeFactory   FACTORY_NAME "DatabaseQueryLooper Output Output Renamer/Nuker"   INPUT FEATURE_TYPE DatabaseQueryLooper_Output   OUTPUT FEATURE_TYPE DatabaseQueryLooper_Output
# -------------------------------------------------------------------------

# Wipe out the source setting if it was untouched from the default setting

DEFAULT_MACRO Reprojector_SOURCE "Read from feature"
INCLUDE [if { {Read from feature} == {Read from feature} } {             puts {MACRO Reprojector_SOURCE}          }         ]
Tcl2 proc Reprojector_warnIfSourceIgnored {chosenSource} {   global FME_CoordSys;   global Reprojector_haveWarned;   if { [info exists Reprojector_haveWarned] == 0        && $chosenSource != {}        && $FME_CoordSys != {}        && $chosenSource != $FME_CoordSys } {      set Reprojector_haveWarned 1;      FME_LogMessage fme_warn \"Reprojector: Ignoring source coordinate system '$chosenSource' in favor of feature coordinate system. This warning will not be repeated\";   }; }
# Passing in source CS to @Tcl rather than referencing it directly to allow
# attribute evalutation to be performed.
FACTORY_DEF * TeeFactory    FACTORY_NAME Reprojector    INPUT  FEATURE_TYPE DatabaseQueryLooper_Output    OUTPUT FEATURE_TYPE Reprojector_REPROJECTED         @Tcl2("Reprojector_warnIfSourceIgnored {$(Reprojector_SOURCE)}")         @Reproject($(Reprojector_SOURCE),"EPSG:4326",NearestNeighbor,PreserveCells)

# -------------------------------------------------------------------------

# First determine which function we are going to be using -- we can do
# this statically at parse time for efficiency sake

MACRO GeometryExtractor_Function
INCLUDE [ if {{GEOJSON} == {fmebinary} } {               puts {MACRO GeometryExtractor_Function @Geometry(TO_ATTRIBUTE_BINARY,"_geometryupdated") }           } elseif {{GEOJSON} == {fmehex} } {               puts {MACRO GeometryExtractor_Function @Geometry(TO_ATTRIBUTE_BINARY_HEX,"_geometryupdated") }           } elseif {{GEOJSON} == {fmexml} } {               puts {MACRO GeometryExtractor_Function @Geometry(TO_ATTRIBUTE,"_geometryupdated") }           } elseif {{GEOJSON} == {polyline} } {               puts {MACRO GeometryExtractor_Function @Geometry(TO_ATTRIBUTE_POLYLINE,"_geometryupdated",<Unused>) }           } elseif {{GEOJSON} == {wkt} ||                      {GEOJSON} == {wkb} ||                      {GEOJSON} == {wkbhex} } {               puts {MACRO GeometryExtractor_Function @OGCGeometry(to_attribute,GEOJSON,"_geometryupdated",<Unused>) }           } elseif {{GEOJSON} == {GEOJSON} ||                     {GEOJSON} == {ESRIJSON} } {               puts {MACRO GeometryExtractor_Function @JSONGeometry(TO_ATTRIBUTE,GEOJSON,"_geometryupdated") }           } elseif {{GEOJSON} == {KML} } {               puts {MACRO GeometryExtractor_Function @KMLGeometry(TO_ATTRIBUTE,"_geometryupdated",<Unused>) }           } elseif {{GEOJSON} == {GEORSS_SIMPLE} } {               puts {MACRO GeometryExtractor_Function @GeoRSSGeometry(TO_ATTRIBUTE,GEOJSON,"_geometryupdated",<Unused>) }           } elseif {{GEOJSON} == {GML_2.1.2} ||                     {GEOJSON} == {GML_3.1.1} ||                     {GEOJSON} == {GML_3.2.1} } {               puts {MACRO GeometryExtractor_Function @GMLGeometry(TO_ATTRIBUTE,GEOJSON,"_geometryupdated",<Unused>) }           } elseif {{GEOJSON} == {geohash} } {               puts {MACRO GeometryExtractor_Function @GeoHash(TO_ATTRIBUTE,"_geometryupdated",<Unused>) }           } elseif {{GEOJSON} == {ogeosms} } {               puts {MACRO GeometryExtractor_Function @OGCGeometry(to_attribute,GEOJSON,"_geometryupdated",<Unused>) }           } elseif {{GEOJSON} == {geosms} ||                     {GEOJSON} == {geo}    } {               puts {MACRO GeometryExtractor_Function @OGCGeometry(to_attribute,GEOJSON,"_geometryupdated") }           } elseif {{GEOJSON} == {mgrs} } {               puts {MACRO GeometryExtractor_Function @SupplyAttributes(_geometryupdated, @MGRS(TO_MGRS, <Unused>, <Unused>, "<Unused>")) }           }         ]
FACTORY_DEF * TeeFactory    FACTORY_NAME GeometryExtractor    INPUT  FEATURE_TYPE Reprojector_REPROJECTED    OUTPUT FEATURE_TYPE GeometryExtractor_OUTPUT         $(GeometryExtractor_Function)

# -------------------------------------------------------------------------

Tcl2 proc ParameterFetcher_doFetch {} {    foreach {name val} {"_type {$(type$encode)}"} {         if { [string match {*<at>*} $val] == 1 } {             set val [FME_Execute EvaluateExpression {STRING} $val {ParameterFetcher}];         } elseif {[string match {*FME_CONDITIONAL*} $val] == 1} {             set val [FME_Execute EvaluateExpression {STRING} $val {ParameterFetcher}];         } else {             set val [FME_DecodeTextOrAttr $val];         };       FME_SetAttribute [FME_DecodeText $name] $val    } }
FACTORY_DEF * TeeFactory    FACTORY_NAME ParameterFetcher    INPUT  FEATURE_TYPE GeometryExtractor_OUTPUT    OUTPUT FEATURE_TYPE ParameterFetcher_OUTPUT         @Tcl2(ParameterFetcher_doFetch)

# -------------------------------------------------------------------------


Tcl2 proc StringConcatenator_evaluator {} {    if {{OUTGOING} == {OUTGOING}} {      set attr [FME_DecodeText {message}];      if {[string length $attr] == 0} { return; };      set attrs [list [FME_EncodeText $attr]];    } else {      set attrAll {<Unused>};      if {[string length $attrAll] == 0} { return; };      set attrs [split {<Unused>} { }];    };    set parmList {{EvaluateExpression} {ATTR_CREATE_EXPR_PROPOGATE_MISSING_FDIV}};    foreach attr $attrs {     lappend parmList $attr;     lappend parmList {"<opencurly><quote>id<quote><space>:<space><quote><at>Value<openparen>feature_id<closeparen><quote><comma><quote>type<quote>:<space><quote><at>Value<openparen>_type<closeparen><quote><comma><quote>features<quote><space>:<space><openbracket><space><at>Value<openparen>_geometryupdated<closeparen><closebracket><closecurly>"};    };    lappend parmList {StringConcatenator};    eval FME_Execute $parmList; }
FACTORY_DEF * TeeFactory    FACTORY_NAME StringConcatenator    INPUT  FEATURE_TYPE ParameterFetcher_OUTPUT    OUTPUT FEATURE_TYPE StringConcatenator_OUTPUT         @Tcl2("StringConcatenator_evaluator ")


# -------------------------------------------------------------------------

# This is just a simple delay, which is given a # of seconds to stall

Tcl2 proc Decelerator_delay {seconds unused} {     after [expr round($seconds * 1000)]; }
Tcl2 set Decelerator_clockMillisecondsWhenLastFeatureWentBy [clock clicks -milliseconds];

# This proc ensures that no more than some maximum number of features get through each second

Tcl2 proc Decelerator_maxpersecond {unused maxFeaturesPerSecond} {     global Decelerator_clockMillisecondsWhenLastFeatureWentBy;     set minimumDelayInMilliseconds [expr 1000.0 / $maxFeaturesPerSecond];     set clockMillisecondsNow [clock clicks -milliseconds];     set milliSecondsSinceLastFeature [expr $clockMillisecondsNow -                    [set Decelerator_clockMillisecondsWhenLastFeatureWentBy]];     if {$milliSecondsSinceLastFeature < $minimumDelayInMilliseconds} {         after [expr round($minimumDelayInMilliseconds - $milliSecondsSinceLastFeature)];     };     set Decelerator_clockMillisecondsWhenLastFeatureWentBy [clock clicks -milliseconds]; }
# Now set up which of the above two delay procedures we'll actually
# use by renaming the one we want to "Decelerator_Waiter"
# Then that is what we'll actually call when a feature goes by.

Tcl2 if { {Per Feature Delay} == {Per Feature Delay} } {         rename Decelerator_delay Decelerator_Waiter;      } else {         rename Decelerator_maxpersecond Decelerator_Waiter;      };
FACTORY_DEF * TeeFactory    FACTORY_NAME Decelerator    INPUT  FEATURE_TYPE StringConcatenator_OUTPUT    OUTPUT FEATURE_TYPE Decelerator_OUTPUT         @Tcl2("Decelerator_Waiter {0.01} {<Unused>}")

# -------------------------------------------------------------------------

FACTORY_DEF * COM.safe.fme.factory.WebSocketFactory    FACTORY_NAME WebSocketSender       INPUT  FEATURE_TYPE Decelerator_OUTPUT    DIRECTION SEND    INITIATION_SEQUENCE CONNECT    HOST "@EvaluateExpression(STRING,@EvaluateExpression(FDIV,STRING,$(WEBSOCKET_URL$encode),WebSocketSender),WebSocketSender)"    PREAMBLE "@EvaluateExpression(STRING,<opencurly><lf><space><space><space><space><quote>ws_op<quote>:<space><quote>open<quote><comma><lf><space><space><space><space><quote>ws_stream_id<quote>:<space><quote>cadqa<quote><lf><closecurly>,WebSocketSender)"    DATA "@EvaluateExpression(STRING,@EvaluateExpression(FDIV,STRING_ENCODED,<opencurly><lf><space><space><space><space><apos>ws_op<apos>:<space><apos>send<apos><comma><lf><space><space><space><space><apos>ws_msg<apos>:<space><apos><at>Value<openparen>message<closeparen><apos><lf><closecurly>,WebSocketSender),WebSocketSender)"    VERIFY_SSL_CERTIFICATES_BOOL true

# -------------------------------------------------------------------------

FACTORY_DEF * RoutingFactory FACTORY_NAME "Destination Feature Type Routing Correlator"   INPUT FEATURE_TYPE *   OUTPUT ROUTED FEATURE_TYPE * @FeatureType(ENCODED,@Value(__wb_out_feat_type__)) @RemoveAttributes(__wb_out_feat_type__)   OUTPUT NOT_ROUTED FEATURE_TYPE __nuke_me__ @Tcl2("FME_StatMessage 818059 [FME_GetAttribute fme_template_feature_type] 818060 818061 fme_warn")
# -------------------------------------------------------------------------

FACTORY_DEF * TeeFactory   FACTORY_NAME "Final Output Nuker"   INPUT FEATURE_TYPE __nuke_me__

